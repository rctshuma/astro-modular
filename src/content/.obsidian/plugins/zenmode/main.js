/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

"use strict";
var __create = Object.create;
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toESM = (mod, isNodeMode, target) => (target = mod != null ? __create(__getProtoOf(mod)) : {}, __copyProps(
  // If the importer is in node compatibility mode or this is not an ESM
  // file that has been converted to a CommonJS file using a Babel-
  // compatible transform (i.e. "__esModule" has not been set), then set
  // "default" to the CommonJS "module.exports" for node compatibility.
  isNodeMode || !mod || !mod.__esModule ? __defProp(target, "default", { value: mod, enumerable: true }) : target,
  mod
));
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => ZenMode
});
module.exports = __toCommonJS(main_exports);
var import_obsidian3 = require("obsidian");

// src/settings.ts
var DEFAULT_SETTINGS = {
  zenMode: false,
  leftSidebar: false,
  rightSidebar: false,
  fullscreen: false,
  exitButtonVisibility: "always",
  autoHideButtonOnDesktop: false,
  hideProperties: false,
  hideInlineTitle: false,
  topPadding: 0,
  bottomPadding: 0,
  focusedFileMode: false,
  hideStatusBar: false
};

// src/settings-tab.ts
var import_obsidian2 = require("obsidian");

// src/utils/settings-compat.ts
var import_obsidian = require("obsidian");
var ObsidianModule = __toESM(require("obsidian"), 1);
function createSettingsGroup(containerEl, heading, manifestId) {
  if ((0, import_obsidian.requireApiVersion)("1.11.0")) {
    const SettingGroupClass = ObsidianModule.SettingGroup;
    if (SettingGroupClass) {
      const group = heading ? new SettingGroupClass(containerEl).setHeading(heading) : new SettingGroupClass(containerEl);
      return {
        addSetting(cb) {
          group.addSetting(cb);
        }
      };
    }
  }
  if (manifestId) {
    containerEl.addClass(`${manifestId}-settings-compat`);
  }
  {
    if (heading) {
      const headingEl = containerEl.createDiv("setting-group-heading");
      headingEl.createEl("h3", { text: heading });
    }
    return {
      addSetting(cb) {
        const setting = new import_obsidian.Setting(containerEl);
        cb(setting);
      }
    };
  }
}

// src/settings-tab.ts
var ZenModeSettingTab = class extends import_obsidian2.PluginSettingTab {
  /**
   * Creates a new settings tab instance.
   * @param app - The Obsidian app instance
   * @param plugin - The Zen Mode plugin instance
   */
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  /**
   * Displays the settings tab UI.
   * Creates all setting controls and registers change handlers.
   */
  display() {
    const { containerEl } = this;
    containerEl.empty();
    const generalGroup = createSettingsGroup(
      containerEl,
      void 0,
      "zenmode"
    );
    generalGroup.addSetting((setting) => {
      setting.setName("Full screen").setDesc(
        "Automatically enter fullscreen when enabling zen mode."
      ).addToggle(
        (toggle) => toggle.setValue(this.plugin.settings.fullscreen).onChange((value) => {
          this.plugin.settings.fullscreen = value;
          void this.plugin.saveSettings();
        })
      );
    });
    generalGroup.addSetting((setting) => {
      setting.setName("Show zen mode exit button").setDesc(
        "When to show the exit button in zen mode. You can also exit via the command palette, by pressing esc, or by assigning a hotkey to the 'toggle zen mode' command."
      ).addDropdown(
        (dropdown) => dropdown.addOption("always", "Always show").addOption("mobile-only", "Mobile only").addOption("never", "Never show").setValue(this.plugin.settings.exitButtonVisibility).onChange((value) => {
          this.plugin.settings.exitButtonVisibility = value;
          void this.plugin.saveSettings();
          this.plugin.refresh();
        })
      );
    });
    generalGroup.addSetting((setting) => {
      setting.setName("Auto-hide zen mode exit button on desktop").setDesc(
        "When enabled, the exit button is hidden on desktop but reveals itself on hover as long as the zen mode exit button is on."
      ).addToggle(
        (toggle) => toggle.setValue(this.plugin.settings.autoHideButtonOnDesktop).onChange((value) => {
          this.plugin.settings.autoHideButtonOnDesktop = value;
          void this.plugin.saveSettings();
          this.plugin.refresh();
        })
      );
    });
    generalGroup.addSetting((setting) => {
      setting.setName("Hide properties in zen mode").setDesc("Hide properties when zen mode is active.").addToggle(
        (toggle) => toggle.setValue(this.plugin.settings.hideProperties).onChange((value) => {
          this.plugin.settings.hideProperties = value;
          void this.plugin.saveSettings();
          this.plugin.refresh();
        })
      );
    });
    generalGroup.addSetting((setting) => {
      setting.setName("Hide inline title in zen mode").setDesc(
        "Hide the inline title (note title) when zen mode is active."
      ).addToggle(
        (toggle) => toggle.setValue(this.plugin.settings.hideInlineTitle).onChange((value) => {
          this.plugin.settings.hideInlineTitle = value;
          void this.plugin.saveSettings();
          this.plugin.refresh();
        })
      );
    });
    generalGroup.addSetting((setting) => {
      setting.setName("Hide status bar in zen mode").setDesc("Hide the status bar when zen mode is active.").addToggle(
        (toggle) => toggle.setValue(this.plugin.settings.hideStatusBar).onChange((value) => {
          this.plugin.settings.hideStatusBar = value;
          void this.plugin.saveSettings();
          this.plugin.refresh();
        })
      );
    });
    generalGroup.addSetting((setting) => {
      setting.setName("Top padding").setDesc("Top padding in pixels (0-100).").addSlider(
        (slider) => slider.setLimits(0, 100, 1).setValue(this.plugin.settings.topPadding).setDynamicTooltip().onChange((value) => {
          this.plugin.settings.topPadding = value;
          void this.plugin.saveSettings();
          this.plugin.refresh();
        })
      );
    });
    generalGroup.addSetting((setting) => {
      setting.setName("Bottom padding").setDesc("Bottom padding in pixels (0-100).").addSlider(
        (slider) => slider.setLimits(0, 100, 1).setValue(this.plugin.settings.bottomPadding).setDynamicTooltip().onChange((value) => {
          this.plugin.settings.bottomPadding = value;
          void this.plugin.saveSettings();
          this.plugin.refresh();
        })
      );
    });
    generalGroup.addSetting((setting) => {
      setting.setName("Focused file mode").setDesc(
        "Only show the active file in zen mode, hide all other panes."
      ).addToggle(
        (toggle) => toggle.setValue(this.plugin.settings.focusedFileMode).onChange((value) => {
          this.plugin.settings.focusedFileMode = value;
          void this.plugin.saveSettings();
          this.plugin.refresh();
        })
      );
    });
  }
};

// src/utils/helpers.ts
function setCssProps(element, props) {
  Object.entries(props).forEach(([key, value]) => {
    const cssKey = key.replace(/([a-z])([A-Z])/g, "$1-$2").toLowerCase();
    element.style.setProperty(cssKey, value);
  });
}

// src/main.ts
var ZenMode = class extends import_obsidian3.Plugin {
  constructor() {
    super(...arguments);
    // Safe: always initialized in onload
    this.hasButton = false;
    this._isTogglingZen = false;
    this.visualViewportResizeHandler = null;
    this._hasShownInitialHighlight = false;
    this._highlightTimeouts = [];
    /**
     * Refreshes the plugin state after settings changes.
     * Updates styles, sidebar visibility, button visibility, and focused file mode.
     */
    this.refresh = () => {
      this.updateStyle();
      this.setSidebarVisibility();
      this.setButtonVisibility();
      void this.updateFocusedFileMode();
    };
    /**
     * Updates CSS classes and data attributes based on current zen mode settings.
     * Applies zen mode styling, padding, and feature flags to the document body.
     */
    this.updateStyle = () => {
      document.body.classList.toggle("zenmode-active", this.settings.zenMode);
      document.documentElement.style.setProperty(
        "--zen-mode-top-padding",
        `${this.settings.topPadding}px`
      );
      document.documentElement.style.setProperty(
        "--zen-mode-bottom-padding",
        `${this.settings.bottomPadding}px`
      );
      if (this.settings.zenMode) {
        document.body.classList.toggle(
          "zenmode-hide-properties",
          this.settings.hideProperties
        );
        document.body.classList.toggle(
          "zenmode-hide-status-bar",
          this.settings.hideStatusBar
        );
      } else {
        document.body.classList.remove("zenmode-hide-properties");
        document.body.classList.remove("zenmode-hide-status-bar");
      }
      if (this.settings.zenMode) {
        document.body.setAttribute(
          "data-zen-hide-inline-title",
          this.settings.hideInlineTitle.toString()
        );
        document.body.setAttribute(
          "data-zen-focused-file",
          this.settings.focusedFileMode.toString()
        );
      } else {
        document.body.removeAttribute("data-zen-hide-inline-title");
        document.body.removeAttribute("data-zen-focused-file");
      }
    };
  }
  /**
   * Called when the plugin is loaded.
   * Initializes settings, registers commands, ribbon icon, and event handlers.
   */
  async onload() {
    await this.loadSettings();
    this.addSettingTab(new ZenModeSettingTab(this.app, this));
    this.addCommand({
      id: "toggle-zen-mode",
      name: "Toggle",
      callback: () => {
        void this.toggleZenMode();
      }
    });
    this.addRibbonIcon("expand", "Toggle zen mode", () => {
      void this.toggleZenMode();
    });
    this.registerEvent(
      this.app.workspace.on("active-leaf-change", () => {
        void this.updateFocusedFileMode();
      })
    );
    this.registerDomEvent(document, "keydown", (evt) => {
      var _a;
      if (evt.key === "Escape" && this.settings.zenMode) {
        const target = evt.target;
        if (target) {
          const cmEditor = target.closest(".cm-editor");
          if (cmEditor) {
            const vault = this.app.vault;
            if (((_a = vault.config) == null ? void 0 : _a.vimMode) === true) {
              return;
            }
          }
          if (target instanceof HTMLTextAreaElement && target.className && target.className.includes("excalidraw")) {
            return;
          }
        }
        const activeModal = document.querySelector(".modal");
        if (!activeModal) {
          void this.toggleZenMode();
          evt.preventDefault();
        }
      }
    });
    this.refresh();
  }
  /**
   * Called when the plugin is unloaded.
   * Cleans up event listeners, timeouts, and removes the exit button.
   */
  onunload() {
    this._highlightTimeouts.forEach((id) => clearTimeout(id));
    if (this.buttonContainer) {
      this.buttonContainer.remove();
    }
    if (this.visualViewportResizeHandler && window.visualViewport) {
      window.visualViewport.removeEventListener(
        "resize",
        this.visualViewportResizeHandler
      );
    }
  }
  /**
   * Loads settings from disk, merging with default settings.
   */
  async loadSettings() {
    const loadedData = await this.loadData();
    this.settings = { ...DEFAULT_SETTINGS, ...loadedData };
  }
  /**
   * Saves current settings to disk.
   */
  async saveSettings() {
    await this.saveData(this.settings);
  }
  /**
   * Manages sidebar visibility based on zen mode state.
   * When entering zen mode, saves current sidebar state and collapses sidebars.
   * When exiting zen mode, restores sidebars to their previous state.
   */
  setSidebarVisibility() {
    const app = this.app;
    if (app.workspace.leftSplit == void 0 || app.workspace.rightSplit == void 0) {
      return;
    }
    if (!this.settings.zenMode) {
      if (!this.settings.leftSidebar) {
        app.workspace.leftSplit.expand();
      }
      if (!this.settings.rightSidebar) {
        app.workspace.rightSplit.expand();
      }
    } else {
      this.settings.rightSidebar = this.app.workspace.rightSplit.collapsed;
      this.settings.leftSidebar = this.app.workspace.leftSplit.collapsed;
      if (app.workspace.leftSplit.collapsed != this.settings.zenMode) {
        app.workspace.leftSplit.collapse();
      }
      if (app.workspace.rightSplit.collapsed != this.settings.zenMode) {
        app.workspace.rightSplit.collapse();
      }
    }
  }
  /**
   * Creates the zen mode exit button and registers event listeners for positioning.
   * The button allows users to exit zen mode and adjusts position for mobile navigation bars.
   */
  createButton() {
    this.buttonContainer = document.createElement("div");
    this.buttonContainer.classList.add("zenmode-button");
    this.button = new import_obsidian3.ButtonComponent(this.buttonContainer);
    this.button.setIcon("shrink");
    this.button.onClick(() => {
      void this.toggleZenMode();
    });
    document.body.appendChild(this.buttonContainer);
    this.adjustButtonPosition();
    this.registerDomEvent(window, "resize", () => {
      this.adjustButtonPosition();
    });
    if (window.visualViewport) {
      this.visualViewportResizeHandler = () => {
        this.adjustButtonPosition();
      };
      window.visualViewport.addEventListener(
        "resize",
        this.visualViewportResizeHandler
      );
    }
  }
  /**
   * Adjusts the exit button position on mobile devices to account for navigation bars.
   * Calculates safe bottom offset using visual viewport API to handle Android navigation bars
   * that may not be detected by CSS safe-area-inset.
   */
  adjustButtonPosition() {
    var _a;
    if (!this.buttonContainer || !document.body.classList.contains("is-mobile")) {
      return;
    }
    const viewportHeight = ((_a = window.visualViewport) == null ? void 0 : _a.height) || window.innerHeight;
    const windowHeight = window.outerHeight;
    const navigationBarHeight = Math.max(0, windowHeight - viewportHeight);
    const minBottomOffset = 60;
    const calculatedOffset = Math.max(
      minBottomOffset,
      navigationBarHeight + 10
    );
    setCssProps(this.buttonContainer, { bottom: `${calculatedOffset}px` });
  }
  /**
   * Controls the visibility of the zen mode exit button based on settings.
   * Handles button creation, auto-hide behavior on desktop, and initial highlight animation.
   */
  setButtonVisibility() {
    const isMobile = document.body.classList.contains("is-mobile");
    const shouldShow = this.settings.zenMode && (this.settings.exitButtonVisibility === "always" || this.settings.exitButtonVisibility === "mobile-only" && isMobile);
    if (shouldShow) {
      if (!this.hasButton) {
        this.createButton();
        this.hasButton = true;
      }
      this.buttonContainer.classList.add("zenmode-button-visible");
      if (this.settings.autoHideButtonOnDesktop && !isMobile && this.settings.exitButtonVisibility === "always") {
        this.buttonContainer.classList.add("zenmode-button-auto-hide");
        if (!this._hasShownInitialHighlight) {
          this.buttonContainer.classList.add(
            "zenmode-button-initial-highlight"
          );
          this._hasShownInitialHighlight = true;
          const timeout1 = window.setTimeout(() => {
            if (this.buttonContainer) {
              this.buttonContainer.classList.remove(
                "zenmode-button-initial-highlight"
              );
              const timeout2 = window.setTimeout(() => {
                if (this.buttonContainer) {
                  this.buttonContainer.classList.add(
                    "zenmode-button-fade-out"
                  );
                }
              }, 300);
              this._highlightTimeouts.push(timeout2);
            }
          }, 1500);
          this._highlightTimeouts.push(timeout1);
        }
      } else {
        this.buttonContainer.classList.remove(
          "zenmode-button-auto-hide"
        );
        this.buttonContainer.classList.remove(
          "zenmode-button-initial-highlight"
        );
        this.buttonContainer.classList.remove(
          "zenmode-button-fade-out"
        );
      }
      this.adjustButtonPosition();
    } else {
      if (this.hasButton) {
        this.buttonContainer.classList.remove(
          "zenmode-button-visible"
        );
      }
    }
  }
  /**
   * Helper function to get the tab container from a workspace leaf.
   * Returns null if the leaf doesn't have a valid container or tab container.
   */
  getTabContainerFromLeaf(leaf) {
    var _a;
    if (!leaf) return null;
    const leafWithContainer = leaf;
    const leafContainer = (_a = leafWithContainer.containerEl) != null ? _a : null;
    if (!leafContainer) return null;
    const tabContainer = leafContainer.closest(".workspace-tabs");
    if (!tabContainer || !(tabContainer instanceof HTMLElement))
      return null;
    return tabContainer;
  }
  /**
   * Finds and reveals a pinned tab if one exists.
   * This should be called BEFORE entering zen mode to prevent new tabs from being created.
   */
  async revealPinnedTabIfExists() {
    var _a;
    try {
      const markdownLeaves = this.app.workspace.getLeavesOfType("markdown");
      for (const leaf of markdownLeaves) {
        const leafWithPinned = leaf;
        let isPinned = false;
        if (leafWithPinned.pinned === true) {
          isPinned = true;
        } else if ((_a = leafWithPinned.view) == null ? void 0 : _a.getState) {
          const state = leafWithPinned.view.getState();
          if (state.pinned === true) {
            isPinned = true;
          }
        }
        const leafWithContainer = leaf;
        if (leafWithContainer.containerEl) {
          const tabHeader = leafWithContainer.containerEl.querySelector(
            ".workspace-tab-header"
          );
          if (tabHeader && tabHeader instanceof HTMLElement) {
            if (tabHeader.classList.contains("is-pinned") || tabHeader.hasAttribute("data-pinned")) {
              isPinned = true;
            }
          }
        }
        if (isPinned) {
          void this.app.workspace.revealLeaf(leaf);
          await new Promise((resolve) => {
            requestAnimationFrame(() => {
              requestAnimationFrame(() => resolve());
            });
          });
          return;
        }
      }
    } catch (e) {
    }
  }
  /**
   * Helper function to find the active tab container by checking the DOM.
   * Looks for tabs with the 'is-active' class or visible active tab headers.
   */
  findActiveTabContainerFromDOM() {
    const activeTabHeader = document.querySelector(
      ".workspace-tab-header.is-active"
    );
    if (activeTabHeader) {
      const tabContainer = activeTabHeader.closest(".workspace-tabs");
      if (tabContainer && tabContainer instanceof HTMLElement) {
        return tabContainer;
      }
    }
    const allTabContainers = Array.from(
      document.querySelectorAll(".workspace-tabs")
    );
    for (const container of allTabContainers) {
      const el = container;
      if (el.offsetParent !== null && !el.classList.contains("zenmode-tab-hidden")) {
        return el;
      }
    }
    return null;
  }
  /**
   * Updates focused file mode visibility.
   * When enabled, hides all workspace tab containers except the one containing the active leaf,
   * showing only the currently focused file. When disabled, restores all tab containers.
   * Uses multiple fallback methods to handle pinned tabs and edge cases.
   */
  async updateFocusedFileMode() {
    if (!this.settings.zenMode || !this.settings.focusedFileMode) {
      const allTabContainers2 = document.querySelectorAll(".workspace-tabs");
      allTabContainers2.forEach((container) => {
        const el = container;
        el.classList.remove("zenmode-tab-hidden");
        el.classList.remove("zenmode-tab-active");
        setCssProps(el, { display: "", width: "", flex: "" });
      });
      return;
    }
    await this.revealPinnedTabIfExists();
    const allTabContainers = Array.from(
      document.querySelectorAll(".workspace-tabs")
    );
    let activeTabContainer = null;
    for (const container of allTabContainers) {
      const el = container;
      const pinnedTabs = Array.from(
        el.querySelectorAll(
          ".workspace-tab-header.is-pinned, .workspace-tab-header[data-pinned='true']"
        )
      );
      if (pinnedTabs.length > 0) {
        activeTabContainer = el;
        break;
      }
    }
    if (!activeTabContainer) {
      const mostRecentLeaf = this.app.workspace.getMostRecentLeaf();
      if (mostRecentLeaf) {
        activeTabContainer = this.getTabContainerFromLeaf(mostRecentLeaf);
      }
    }
    if (!activeTabContainer) {
      const activeTabFromDOM = this.findActiveTabContainerFromDOM();
      if (activeTabFromDOM) {
        activeTabContainer = activeTabFromDOM;
      }
    }
    if (!activeTabContainer) {
      return;
    }
    allTabContainers.forEach((tabContainer) => {
      const el = tabContainer;
      if (tabContainer === activeTabContainer) {
        el.classList.remove("zenmode-tab-hidden");
        setCssProps(el, {
          display: "",
          width: "100%",
          flex: "1 1 100%"
        });
      } else {
        el.classList.add("zenmode-tab-hidden");
        setCssProps(el, { display: "none" });
      }
    });
  }
  /**
   * Toggles zen mode on or off.
   * Handles fullscreen entry/exit if enabled, updates settings, and refreshes the UI.
   * Includes guard against concurrent invocations to prevent race conditions.
   */
  async toggleZenMode() {
    if (this._isTogglingZen) {
      return;
    }
    this._isTogglingZen = true;
    try {
      const enteringZenMode = !this.settings.zenMode;
      if (!enteringZenMode) {
        this._hasShownInitialHighlight = false;
      }
      if (enteringZenMode) {
        if (this.settings.focusedFileMode) {
          await this.revealPinnedTabIfExists();
        }
        if (this.settings.fullscreen && document.documentElement.requestFullscreen) {
          try {
            await document.documentElement.requestFullscreen();
            await new Promise(
              (resolve) => requestAnimationFrame(resolve)
            );
          } catch (e) {
          }
        }
        this.settings.zenMode = true;
        await this.saveSettings();
        this.refresh();
      } else {
        if (document.fullscreenElement && document.exitFullscreen) {
          try {
            await document.exitFullscreen();
            await new Promise(
              (resolve) => requestAnimationFrame(resolve)
            );
          } catch (e) {
          }
        }
        this.settings.zenMode = false;
        await this.saveSettings();
        this.refresh();
      }
    } finally {
      this._isTogglingZen = false;
    }
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiLCAic3JjL3NldHRpbmdzLnRzIiwgInNyYy9zZXR0aW5ncy10YWIudHMiLCAic3JjL3V0aWxzL3NldHRpbmdzLWNvbXBhdC50cyIsICJzcmMvdXRpbHMvaGVscGVycy50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgQnV0dG9uQ29tcG9uZW50LCBQbHVnaW4sIFdvcmtzcGFjZUxlYWYgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IERFRkFVTFRfU0VUVElOR1MsIHR5cGUgWmVuTW9kZVNldHRpbmdzIH0gZnJvbSBcIi4vc2V0dGluZ3NcIjtcbmltcG9ydCB7IFplbk1vZGVTZXR0aW5nVGFiIH0gZnJvbSBcIi4vc2V0dGluZ3MtdGFiXCI7XG5pbXBvcnQgeyBzZXRDc3NQcm9wcyB9IGZyb20gXCIuL3V0aWxzL2hlbHBlcnNcIjtcblxuLyoqXG4gKiBaZW4gTW9kZSBwbHVnaW4gZm9yIE9ic2lkaWFuLlxuICogSGlkZXMgbW9zdCBVSSBlbGVtZW50cyB0byBlbmFibGUgZm9jdXNlZCBjb250ZW50IGNvbnN1bXB0aW9uIGFuZCBwcmVzZW50YXRpb25zLlxuICogUHJvdmlkZXMgYSBcInplbiBtb2RlXCIgdGhhdCBoaWRlcyBhbGwgVUkgZWxlbWVudHMgZXhjZXB0IHRoZSBjdXJyZW50IHRleHQgZmlsZSBvciBkb2N1bWVudCxcbiAqIGxlYXZpbmcgb25seSBhIHNpbmdsZSBidXR0b24gdG8gcmVzdG9yZSBhbGwgVUkuIE9uIGRlc2t0b3AsIGl0IGFsc28gY29sbGFwc2VzIGFuZCByZXN0b3Jlc1xuICogc2lkZWJhcnMgd2hlbiB0b2dnbGVkLCBhbGxvd2luZyBxdWljayBzd2l0Y2hpbmcgZnJvbSBhbiBlZGl0aW5nLWZyaWVuZGx5IGV4cGVyaWVuY2UgdG9cbiAqIGEgdmlld2luZy1mcmllbmRseSBleHBlcmllbmNlLlxuICovXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBaZW5Nb2RlIGV4dGVuZHMgUGx1Z2luIHtcblx0c2V0dGluZ3MhOiBaZW5Nb2RlU2V0dGluZ3M7IC8vIFNhZmU6IGFsd2F5cyBpbml0aWFsaXplZCBpbiBvbmxvYWRcblx0aGFzQnV0dG9uOiBib29sZWFuID0gZmFsc2U7XG5cdHByaXZhdGUgYnV0dG9uPzogQnV0dG9uQ29tcG9uZW50O1xuXHRwcml2YXRlIGJ1dHRvbkNvbnRhaW5lcj86IEhUTUxEaXZFbGVtZW50O1xuXHRwcml2YXRlIF9pc1RvZ2dsaW5nWmVuOiBib29sZWFuID0gZmFsc2U7XG5cdHByaXZhdGUgdmlzdWFsVmlld3BvcnRSZXNpemVIYW5kbGVyOiAoKCkgPT4gdm9pZCkgfCBudWxsID0gbnVsbDtcblx0cHJpdmF0ZSBfaGFzU2hvd25Jbml0aWFsSGlnaGxpZ2h0OiBib29sZWFuID0gZmFsc2U7XG5cdHByaXZhdGUgX2hpZ2hsaWdodFRpbWVvdXRzOiBudW1iZXJbXSA9IFtdO1xuXG5cdC8qKlxuXHQgKiBDYWxsZWQgd2hlbiB0aGUgcGx1Z2luIGlzIGxvYWRlZC5cblx0ICogSW5pdGlhbGl6ZXMgc2V0dGluZ3MsIHJlZ2lzdGVycyBjb21tYW5kcywgcmliYm9uIGljb24sIGFuZCBldmVudCBoYW5kbGVycy5cblx0ICovXG5cdGFzeW5jIG9ubG9hZCgpIHtcblx0XHQvLyBsb2FkIHNldHRpbmdzXG5cdFx0YXdhaXQgdGhpcy5sb2FkU2V0dGluZ3MoKTtcblxuXHRcdC8vIGFkZCB0aGUgc2V0dGluZ3MgdGFiXG5cdFx0dGhpcy5hZGRTZXR0aW5nVGFiKG5ldyBaZW5Nb2RlU2V0dGluZ1RhYih0aGlzLmFwcCwgdGhpcykpO1xuXHRcdC8vIGFkZCB0aGUgdG9nZ2xlIG9uL29mZiBjb21tYW5kXG5cblx0XHR0aGlzLmFkZENvbW1hbmQoe1xuXHRcdFx0aWQ6IFwidG9nZ2xlLXplbi1tb2RlXCIsXG5cdFx0XHRuYW1lOiBcIlRvZ2dsZVwiLFxuXHRcdFx0Y2FsbGJhY2s6ICgpID0+IHtcblx0XHRcdFx0dm9pZCB0aGlzLnRvZ2dsZVplbk1vZGUoKTtcblx0XHRcdH0sXG5cdFx0fSk7XG5cblx0XHR0aGlzLmFkZFJpYmJvbkljb24oXCJleHBhbmRcIiwgXCJUb2dnbGUgemVuIG1vZGVcIiwgKCkgPT4ge1xuXHRcdFx0dm9pZCB0aGlzLnRvZ2dsZVplbk1vZGUoKTtcblx0XHR9KTtcblxuXHRcdC8vIFJlZ2lzdGVyIGV2ZW50IGxpc3RlbmVyIGZvciBhY3RpdmUgbGVhZiBjaGFuZ2VzIChmb3IgZm9jdXNlZCBmaWxlIG1vZGUpXG5cdFx0dGhpcy5yZWdpc3RlckV2ZW50KFxuXHRcdFx0dGhpcy5hcHAud29ya3NwYWNlLm9uKFwiYWN0aXZlLWxlYWYtY2hhbmdlXCIsICgpID0+IHtcblx0XHRcdFx0dm9pZCB0aGlzLnVwZGF0ZUZvY3VzZWRGaWxlTW9kZSgpO1xuXHRcdFx0fSlcblx0XHQpO1xuXG5cdFx0Ly8gUmVnaXN0ZXIgRVNDIGtleSB0byBleGl0IFplbiBtb2RlXG5cdFx0dGhpcy5yZWdpc3RlckRvbUV2ZW50KGRvY3VtZW50LCBcImtleWRvd25cIiwgKGV2dDogS2V5Ym9hcmRFdmVudCkgPT4ge1xuXHRcdFx0aWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIgJiYgdGhpcy5zZXR0aW5ncy56ZW5Nb2RlKSB7XG5cdFx0XHRcdC8vIERvbid0IGludGVyZmVyZSBpZiB2aW0gbW9kZSBpcyBhY3RpdmUgKHZpbSB1c2VzIEVTQyBmcmVxdWVudGx5KVxuXHRcdFx0XHQvLyBDaGVjayBpZiB0aGUgZXZlbnQgdGFyZ2V0IGlzIHdpdGhpbiBhIENvZGVNaXJyb3IgZWRpdG9yIHdpdGggdmltIGVuYWJsZWRcblx0XHRcdFx0Y29uc3QgdGFyZ2V0ID0gZXZ0LnRhcmdldCBhcyBIVE1MRWxlbWVudDtcblx0XHRcdFx0aWYgKHRhcmdldCkge1xuXHRcdFx0XHRcdGNvbnN0IGNtRWRpdG9yID0gdGFyZ2V0LmNsb3Nlc3QoXCIuY20tZWRpdG9yXCIpO1xuXHRcdFx0XHRcdGlmIChjbUVkaXRvcikge1xuXHRcdFx0XHRcdFx0Ly8gQ2hlY2sgaWYgdmltIG1vZGUgaXMgZW5hYmxlZCBpbiBPYnNpZGlhbiBzZXR0aW5nc1xuXHRcdFx0XHRcdFx0Ly8gTm90ZTogdmF1bHQuY29uZmlnIGlzIG5vdCBpbiBwdWJsaWMgQVBJIHR5cGVzLCBidXQgZXhpc3RzIGF0IHJ1bnRpbWVcblx0XHRcdFx0XHRcdGNvbnN0IHZhdWx0ID0gdGhpcy5hcHBcblx0XHRcdFx0XHRcdFx0LnZhdWx0IGFzIHR5cGVvZiB0aGlzLmFwcC52YXVsdCAmIHtcblx0XHRcdFx0XHRcdFx0Y29uZmlnPzogeyB2aW1Nb2RlPzogYm9vbGVhbiB9O1xuXHRcdFx0XHRcdFx0fTtcblx0XHRcdFx0XHRcdGlmICh2YXVsdC5jb25maWc/LnZpbU1vZGUgPT09IHRydWUpIHtcblx0XHRcdFx0XHRcdFx0Ly8gVmltIG1vZGUgaXMgZW5hYmxlZCwgZG9uJ3QgaW50ZXJmZXJlIHdpdGggRVNDXG5cdFx0XHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHQvLyBEb24ndCBleGl0IGNvbXBhY3QgbW9kZSB3aXRoIGVzY2FwZSBpbiBhbiBleGNhbGlkcmF3IHRleHRib3hlcyBhcyB0aGV5IHVzZSB0aGUgZXNjYXBlIGhvdGtleSB0byBsZWF2ZSBvdXQgb2YgaXRzZWxmLlxuXHRcdFx0XHRcdC8vIFRoZSByZXN1bHRpbmcgYmVoYXZpb3VyIGlzIHZlcnkgY29uZnVzaW5nLiAoVGV4dGJveCBpcyBzdGlsbCBmb2N1cyBidXQgdGhlIHplbm1vZGUgZGlzYWJsZXMpXG5cdFx0XHRcdFx0aWYgKFxuXHRcdFx0XHRcdFx0dGFyZ2V0IGluc3RhbmNlb2YgSFRNTFRleHRBcmVhRWxlbWVudCAmJlxuXHRcdFx0XHRcdFx0dGFyZ2V0LmNsYXNzTmFtZSAmJlxuXHRcdFx0XHRcdFx0dGFyZ2V0LmNsYXNzTmFtZS5pbmNsdWRlcyhcImV4Y2FsaWRyYXdcIilcblx0XHRcdFx0XHQpIHtcblx0XHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0Ly8gT25seSBleGl0IGlmIG5vIG1vZGFsIGlzIG9wZW4gKHRvIGF2b2lkIGludGVyZmVyaW5nIHdpdGggT2JzaWRpYW4gbW9kYWxzKVxuXHRcdFx0XHRjb25zdCBhY3RpdmVNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxcIik7XG5cdFx0XHRcdGlmICghYWN0aXZlTW9kYWwpIHtcblx0XHRcdFx0XHR2b2lkIHRoaXMudG9nZ2xlWmVuTW9kZSgpO1xuXHRcdFx0XHRcdGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHR0aGlzLnJlZnJlc2goKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBDYWxsZWQgd2hlbiB0aGUgcGx1Z2luIGlzIHVubG9hZGVkLlxuXHQgKiBDbGVhbnMgdXAgZXZlbnQgbGlzdGVuZXJzLCB0aW1lb3V0cywgYW5kIHJlbW92ZXMgdGhlIGV4aXQgYnV0dG9uLlxuXHQgKi9cblx0b251bmxvYWQoKSB7XG5cdFx0Ly8gQ2xlYXIgYW55IHBlbmRpbmcgYW5pbWF0aW9uIHRpbWVvdXRzXG5cdFx0dGhpcy5faGlnaGxpZ2h0VGltZW91dHMuZm9yRWFjaCgoaWQpID0+IGNsZWFyVGltZW91dChpZCkpO1xuXHRcdGlmICh0aGlzLmJ1dHRvbkNvbnRhaW5lcikge1xuXHRcdFx0dGhpcy5idXR0b25Db250YWluZXIucmVtb3ZlKCk7XG5cdFx0fVxuXHRcdC8vIENsZWFuIHVwIHZpc3VhbFZpZXdwb3J0IGV2ZW50IGxpc3RlbmVyXG5cdFx0aWYgKHRoaXMudmlzdWFsVmlld3BvcnRSZXNpemVIYW5kbGVyICYmIHdpbmRvdy52aXN1YWxWaWV3cG9ydCkge1xuXHRcdFx0d2luZG93LnZpc3VhbFZpZXdwb3J0LnJlbW92ZUV2ZW50TGlzdGVuZXIoXG5cdFx0XHRcdFwicmVzaXplXCIsXG5cdFx0XHRcdHRoaXMudmlzdWFsVmlld3BvcnRSZXNpemVIYW5kbGVyXG5cdFx0XHQpO1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBMb2FkcyBzZXR0aW5ncyBmcm9tIGRpc2ssIG1lcmdpbmcgd2l0aCBkZWZhdWx0IHNldHRpbmdzLlxuXHQgKi9cblx0YXN5bmMgbG9hZFNldHRpbmdzKCkge1xuXHRcdGNvbnN0IGxvYWRlZERhdGEgPVxuXHRcdFx0KGF3YWl0IHRoaXMubG9hZERhdGEoKSkgYXMgUGFydGlhbDxaZW5Nb2RlU2V0dGluZ3M+IHwgbnVsbDtcblx0XHR0aGlzLnNldHRpbmdzID0geyAuLi5ERUZBVUxUX1NFVFRJTkdTLCAuLi5sb2FkZWREYXRhIH07XG5cdH1cblxuXHQvKipcblx0ICogU2F2ZXMgY3VycmVudCBzZXR0aW5ncyB0byBkaXNrLlxuXHQgKi9cblx0YXN5bmMgc2F2ZVNldHRpbmdzKCkge1xuXHRcdGF3YWl0IHRoaXMuc2F2ZURhdGEodGhpcy5zZXR0aW5ncyk7XG5cdH1cblxuXHQvKipcblx0ICogUmVmcmVzaGVzIHRoZSBwbHVnaW4gc3RhdGUgYWZ0ZXIgc2V0dGluZ3MgY2hhbmdlcy5cblx0ICogVXBkYXRlcyBzdHlsZXMsIHNpZGViYXIgdmlzaWJpbGl0eSwgYnV0dG9uIHZpc2liaWxpdHksIGFuZCBmb2N1c2VkIGZpbGUgbW9kZS5cblx0ICovXG5cdHJlZnJlc2ggPSAoKSA9PiB7XG5cdFx0Ly8gcmUtbG9hZCB0aGUgc3R5bGVcblx0XHR0aGlzLnVwZGF0ZVN0eWxlKCk7XG5cdFx0dGhpcy5zZXRTaWRlYmFyVmlzaWJpbGl0eSgpO1xuXHRcdHRoaXMuc2V0QnV0dG9uVmlzaWJpbGl0eSgpO1xuXHRcdHZvaWQgdGhpcy51cGRhdGVGb2N1c2VkRmlsZU1vZGUoKTtcblx0fTtcblxuXHQvKipcblx0ICogTWFuYWdlcyBzaWRlYmFyIHZpc2liaWxpdHkgYmFzZWQgb24gemVuIG1vZGUgc3RhdGUuXG5cdCAqIFdoZW4gZW50ZXJpbmcgemVuIG1vZGUsIHNhdmVzIGN1cnJlbnQgc2lkZWJhciBzdGF0ZSBhbmQgY29sbGFwc2VzIHNpZGViYXJzLlxuXHQgKiBXaGVuIGV4aXRpbmcgemVuIG1vZGUsIHJlc3RvcmVzIHNpZGViYXJzIHRvIHRoZWlyIHByZXZpb3VzIHN0YXRlLlxuXHQgKi9cblx0c2V0U2lkZWJhclZpc2liaWxpdHkoKSB7XG5cdFx0Ly9jb2xsYXBzZSBzaWRlYmFycyBpZiB6ZW4gbW9kZSBpcyBhY3RpdmVcblx0XHRjb25zdCBhcHAgPSB0aGlzLmFwcDtcblxuXHRcdGlmIChcblx0XHRcdGFwcC53b3Jrc3BhY2UubGVmdFNwbGl0ID09IHVuZGVmaW5lZCB8fFxuXHRcdFx0YXBwLndvcmtzcGFjZS5yaWdodFNwbGl0ID09IHVuZGVmaW5lZFxuXHRcdCkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdGlmICghdGhpcy5zZXR0aW5ncy56ZW5Nb2RlKSB7XG5cdFx0XHRpZiAoIXRoaXMuc2V0dGluZ3MubGVmdFNpZGViYXIpIHtcblx0XHRcdFx0YXBwLndvcmtzcGFjZS5sZWZ0U3BsaXQuZXhwYW5kKCk7XG5cdFx0XHR9XG5cdFx0XHRpZiAoIXRoaXMuc2V0dGluZ3MucmlnaHRTaWRlYmFyKSB7XG5cdFx0XHRcdGFwcC53b3Jrc3BhY2UucmlnaHRTcGxpdC5leHBhbmQoKTtcblx0XHRcdH1cblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy5zZXR0aW5ncy5yaWdodFNpZGViYXIgPVxuXHRcdFx0XHR0aGlzLmFwcC53b3Jrc3BhY2UucmlnaHRTcGxpdC5jb2xsYXBzZWQ7XG5cdFx0XHR0aGlzLnNldHRpbmdzLmxlZnRTaWRlYmFyID0gdGhpcy5hcHAud29ya3NwYWNlLmxlZnRTcGxpdC5jb2xsYXBzZWQ7XG5cblx0XHRcdGlmIChhcHAud29ya3NwYWNlLmxlZnRTcGxpdC5jb2xsYXBzZWQgIT0gdGhpcy5zZXR0aW5ncy56ZW5Nb2RlKSB7XG5cdFx0XHRcdGFwcC53b3Jrc3BhY2UubGVmdFNwbGl0LmNvbGxhcHNlKCk7XG5cdFx0XHR9XG5cblx0XHRcdGlmIChhcHAud29ya3NwYWNlLnJpZ2h0U3BsaXQuY29sbGFwc2VkICE9IHRoaXMuc2V0dGluZ3MuemVuTW9kZSkge1xuXHRcdFx0XHRhcHAud29ya3NwYWNlLnJpZ2h0U3BsaXQuY29sbGFwc2UoKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogVXBkYXRlcyBDU1MgY2xhc3NlcyBhbmQgZGF0YSBhdHRyaWJ1dGVzIGJhc2VkIG9uIGN1cnJlbnQgemVuIG1vZGUgc2V0dGluZ3MuXG5cdCAqIEFwcGxpZXMgemVuIG1vZGUgc3R5bGluZywgcGFkZGluZywgYW5kIGZlYXR1cmUgZmxhZ3MgdG8gdGhlIGRvY3VtZW50IGJvZHkuXG5cdCAqL1xuXHR1cGRhdGVTdHlsZSA9ICgpID0+IHtcblx0XHRkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC50b2dnbGUoXCJ6ZW5tb2RlLWFjdGl2ZVwiLCB0aGlzLnNldHRpbmdzLnplbk1vZGUpO1xuXG5cdFx0Ly8gU2V0IENTUyBjdXN0b20gcHJvcGVydGllcyBmb3IgcGFkZGluZ1xuXHRcdGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zdHlsZS5zZXRQcm9wZXJ0eShcblx0XHRcdFwiLS16ZW4tbW9kZS10b3AtcGFkZGluZ1wiLFxuXHRcdFx0YCR7dGhpcy5zZXR0aW5ncy50b3BQYWRkaW5nfXB4YFxuXHRcdCk7XG5cdFx0ZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlLnNldFByb3BlcnR5KFxuXHRcdFx0XCItLXplbi1tb2RlLWJvdHRvbS1wYWRkaW5nXCIsXG5cdFx0XHRgJHt0aGlzLnNldHRpbmdzLmJvdHRvbVBhZGRpbmd9cHhgXG5cdFx0KTtcblxuXHRcdC8vIFVzZSBjbGFzcyB0b2dnbGUgZm9yIHByb3BlcnRpZXMgaGlkaW5nIChsaWtlIEhpZGVyIHBsdWdpbilcblx0XHQvLyBUb2dnbGUgdGhlIGNsYXNzIGJhc2VkIG9uIHNldHRpbmcgKG9ubHkgd2hlbiB6ZW4gbW9kZSBpcyBhY3RpdmUpXG5cdFx0aWYgKHRoaXMuc2V0dGluZ3MuemVuTW9kZSkge1xuXHRcdFx0ZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QudG9nZ2xlKFxuXHRcdFx0XHRcInplbm1vZGUtaGlkZS1wcm9wZXJ0aWVzXCIsXG5cdFx0XHRcdHRoaXMuc2V0dGluZ3MuaGlkZVByb3BlcnRpZXNcblx0XHRcdCk7XG5cdFx0XHRkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC50b2dnbGUoXG5cdFx0XHRcdFwiemVubW9kZS1oaWRlLXN0YXR1cy1iYXJcIixcblx0XHRcdFx0dGhpcy5zZXR0aW5ncy5oaWRlU3RhdHVzQmFyXG5cdFx0XHQpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5yZW1vdmUoXCJ6ZW5tb2RlLWhpZGUtcHJvcGVydGllc1wiKTtcblx0XHRcdGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LnJlbW92ZShcInplbm1vZGUtaGlkZS1zdGF0dXMtYmFyXCIpO1xuXHRcdH1cblxuXHRcdGlmICh0aGlzLnNldHRpbmdzLnplbk1vZGUpIHtcblx0XHRcdGRvY3VtZW50LmJvZHkuc2V0QXR0cmlidXRlKFxuXHRcdFx0XHRcImRhdGEtemVuLWhpZGUtaW5saW5lLXRpdGxlXCIsXG5cdFx0XHRcdHRoaXMuc2V0dGluZ3MuaGlkZUlubGluZVRpdGxlLnRvU3RyaW5nKClcblx0XHRcdCk7XG5cdFx0XHRkb2N1bWVudC5ib2R5LnNldEF0dHJpYnV0ZShcblx0XHRcdFx0XCJkYXRhLXplbi1mb2N1c2VkLWZpbGVcIixcblx0XHRcdFx0dGhpcy5zZXR0aW5ncy5mb2N1c2VkRmlsZU1vZGUudG9TdHJpbmcoKVxuXHRcdFx0KTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly8gUmVtb3ZlIGRhdGEgYXR0cmlidXRlcyB3aGVuIHplbiBtb2RlIGlzIG9mZlxuXHRcdFx0ZG9jdW1lbnQuYm9keS5yZW1vdmVBdHRyaWJ1dGUoXCJkYXRhLXplbi1oaWRlLWlubGluZS10aXRsZVwiKTtcblx0XHRcdGRvY3VtZW50LmJvZHkucmVtb3ZlQXR0cmlidXRlKFwiZGF0YS16ZW4tZm9jdXNlZC1maWxlXCIpO1xuXHRcdH1cblx0fTtcblxuXHQvKipcblx0ICogQ3JlYXRlcyB0aGUgemVuIG1vZGUgZXhpdCBidXR0b24gYW5kIHJlZ2lzdGVycyBldmVudCBsaXN0ZW5lcnMgZm9yIHBvc2l0aW9uaW5nLlxuXHQgKiBUaGUgYnV0dG9uIGFsbG93cyB1c2VycyB0byBleGl0IHplbiBtb2RlIGFuZCBhZGp1c3RzIHBvc2l0aW9uIGZvciBtb2JpbGUgbmF2aWdhdGlvbiBiYXJzLlxuXHQgKi9cblx0Y3JlYXRlQnV0dG9uKCkge1xuXHRcdHRoaXMuYnV0dG9uQ29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblx0XHR0aGlzLmJ1dHRvbkNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKFwiemVubW9kZS1idXR0b25cIik7XG5cblx0XHR0aGlzLmJ1dHRvbiA9IG5ldyBCdXR0b25Db21wb25lbnQodGhpcy5idXR0b25Db250YWluZXIpO1xuXHRcdHRoaXMuYnV0dG9uLnNldEljb24oXCJzaHJpbmtcIik7XG5cdFx0dGhpcy5idXR0b24ub25DbGljaygoKSA9PiB7XG5cdFx0XHR2b2lkIHRoaXMudG9nZ2xlWmVuTW9kZSgpO1xuXHRcdH0pO1xuXG5cdFx0ZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCh0aGlzLmJ1dHRvbkNvbnRhaW5lcik7XG5cblx0XHQvLyBBZGp1c3QgYnV0dG9uIHBvc2l0aW9uIGZvciBtb2JpbGUgbmF2aWdhdGlvbiBiYXJcblx0XHR0aGlzLmFkanVzdEJ1dHRvblBvc2l0aW9uKCk7XG5cblx0XHQvLyBMaXN0ZW4gZm9yIHJlc2l6ZSBldmVudHMgdG8gYWRqdXN0IHBvc2l0aW9uIHdoZW4gbmF2aWdhdGlvbiBiYXIgYXBwZWFycy9kaXNhcHBlYXJzXG5cdFx0dGhpcy5yZWdpc3RlckRvbUV2ZW50KHdpbmRvdywgXCJyZXNpemVcIiwgKCkgPT4ge1xuXHRcdFx0dGhpcy5hZGp1c3RCdXR0b25Qb3NpdGlvbigpO1xuXHRcdH0pO1xuXG5cdFx0Ly8gQWxzbyBsaXN0ZW4gdG8gdmlzdWFsVmlld3BvcnQgcmVzaXplIGZvciBiZXR0ZXIgbW9iaWxlIHN1cHBvcnRcblx0XHRpZiAod2luZG93LnZpc3VhbFZpZXdwb3J0KSB7XG5cdFx0XHR0aGlzLnZpc3VhbFZpZXdwb3J0UmVzaXplSGFuZGxlciA9ICgpID0+IHtcblx0XHRcdFx0dGhpcy5hZGp1c3RCdXR0b25Qb3NpdGlvbigpO1xuXHRcdFx0fTtcblx0XHRcdHdpbmRvdy52aXN1YWxWaWV3cG9ydC5hZGRFdmVudExpc3RlbmVyKFxuXHRcdFx0XHRcInJlc2l6ZVwiLFxuXHRcdFx0XHR0aGlzLnZpc3VhbFZpZXdwb3J0UmVzaXplSGFuZGxlclxuXHRcdFx0KTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogQWRqdXN0cyB0aGUgZXhpdCBidXR0b24gcG9zaXRpb24gb24gbW9iaWxlIGRldmljZXMgdG8gYWNjb3VudCBmb3IgbmF2aWdhdGlvbiBiYXJzLlxuXHQgKiBDYWxjdWxhdGVzIHNhZmUgYm90dG9tIG9mZnNldCB1c2luZyB2aXN1YWwgdmlld3BvcnQgQVBJIHRvIGhhbmRsZSBBbmRyb2lkIG5hdmlnYXRpb24gYmFyc1xuXHQgKiB0aGF0IG1heSBub3QgYmUgZGV0ZWN0ZWQgYnkgQ1NTIHNhZmUtYXJlYS1pbnNldC5cblx0ICovXG5cdGFkanVzdEJ1dHRvblBvc2l0aW9uKCkge1xuXHRcdGlmIChcblx0XHRcdCF0aGlzLmJ1dHRvbkNvbnRhaW5lciB8fFxuXHRcdFx0IWRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LmNvbnRhaW5zKFwiaXMtbW9iaWxlXCIpXG5cdFx0KSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Ly8gQ2FsY3VsYXRlIHNhZmUgYm90dG9tIG9mZnNldCBmb3IgbW9iaWxlIGRldmljZXNcblx0XHQvLyBUaGlzIGFjY291bnRzIGZvciBBbmRyb2lkIG5hdmlnYXRpb24gYmFycyB0aGF0IG1heSBub3QgYmUgZGV0ZWN0ZWQgYnkgQ1NTIHNhZmUtYXJlYS1pbnNldFxuXHRcdGNvbnN0IHZpZXdwb3J0SGVpZ2h0ID1cblx0XHRcdHdpbmRvdy52aXN1YWxWaWV3cG9ydD8uaGVpZ2h0IHx8IHdpbmRvdy5pbm5lckhlaWdodDtcblx0XHRjb25zdCB3aW5kb3dIZWlnaHQgPSB3aW5kb3cub3V0ZXJIZWlnaHQ7XG5cdFx0Y29uc3QgbmF2aWdhdGlvbkJhckhlaWdodCA9IE1hdGgubWF4KDAsIHdpbmRvd0hlaWdodCAtIHZpZXdwb3J0SGVpZ2h0KTtcblxuXHRcdC8vIFVzZSBhIG1pbmltdW0gb2Zmc2V0IHRvIGVuc3VyZSBidXR0b24gaXMgYWx3YXlzIGFjY2Vzc2libGVcblx0XHQvLyA2MHB4IHNob3VsZCBiZSBlbm91Z2ggdG8gY2xlYXIgbW9zdCBuYXZpZ2F0aW9uIGJhcnNcblx0XHRjb25zdCBtaW5Cb3R0b21PZmZzZXQgPSA2MDtcblx0XHRjb25zdCBjYWxjdWxhdGVkT2Zmc2V0ID0gTWF0aC5tYXgoXG5cdFx0XHRtaW5Cb3R0b21PZmZzZXQsXG5cdFx0XHRuYXZpZ2F0aW9uQmFySGVpZ2h0ICsgMTBcblx0XHQpO1xuXG5cdFx0Ly8gQXBwbHkgdGhlIG9mZnNldFxuXHRcdHNldENzc1Byb3BzKHRoaXMuYnV0dG9uQ29udGFpbmVyLCB7IGJvdHRvbTogYCR7Y2FsY3VsYXRlZE9mZnNldH1weGAgfSk7XG5cdH1cblxuXHQvKipcblx0ICogQ29udHJvbHMgdGhlIHZpc2liaWxpdHkgb2YgdGhlIHplbiBtb2RlIGV4aXQgYnV0dG9uIGJhc2VkIG9uIHNldHRpbmdzLlxuXHQgKiBIYW5kbGVzIGJ1dHRvbiBjcmVhdGlvbiwgYXV0by1oaWRlIGJlaGF2aW9yIG9uIGRlc2t0b3AsIGFuZCBpbml0aWFsIGhpZ2hsaWdodCBhbmltYXRpb24uXG5cdCAqL1xuXHRzZXRCdXR0b25WaXNpYmlsaXR5KCkge1xuXHRcdGNvbnN0IGlzTW9iaWxlID0gZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QuY29udGFpbnMoXCJpcy1tb2JpbGVcIik7XG5cdFx0Y29uc3Qgc2hvdWxkU2hvdyA9XG5cdFx0XHR0aGlzLnNldHRpbmdzLnplbk1vZGUgJiZcblx0XHRcdCh0aGlzLnNldHRpbmdzLmV4aXRCdXR0b25WaXNpYmlsaXR5ID09PSBcImFsd2F5c1wiIHx8XG5cdFx0XHRcdCh0aGlzLnNldHRpbmdzLmV4aXRCdXR0b25WaXNpYmlsaXR5ID09PSBcIm1vYmlsZS1vbmx5XCIgJiZcblx0XHRcdFx0XHRpc01vYmlsZSkpO1xuXG5cdFx0aWYgKHNob3VsZFNob3cpIHtcblx0XHRcdGlmICghdGhpcy5oYXNCdXR0b24pIHtcblx0XHRcdFx0dGhpcy5jcmVhdGVCdXR0b24oKTtcblx0XHRcdFx0dGhpcy5oYXNCdXR0b24gPSB0cnVlO1xuXHRcdFx0fVxuXHRcdFx0dGhpcy5idXR0b25Db250YWluZXIhLmNsYXNzTGlzdC5hZGQoXCJ6ZW5tb2RlLWJ1dHRvbi12aXNpYmxlXCIpO1xuXG5cdFx0XHQvLyBBcHBseSBhdXRvLWhpZGUgY2xhc3MgZm9yIGRlc2t0b3AgaG92ZXIgYmVoYXZpb3Jcblx0XHRcdC8vIE9ubHkgYXBwbGllcyB3aGVuIGV4aXRCdXR0b25WaXNpYmlsaXR5IGlzIFwiYWx3YXlzXCIgYW5kIG9uIGRlc2t0b3Bcblx0XHRcdGlmIChcblx0XHRcdFx0dGhpcy5zZXR0aW5ncy5hdXRvSGlkZUJ1dHRvbk9uRGVza3RvcCAmJlxuXHRcdFx0XHQhaXNNb2JpbGUgJiZcblx0XHRcdFx0dGhpcy5zZXR0aW5ncy5leGl0QnV0dG9uVmlzaWJpbGl0eSA9PT0gXCJhbHdheXNcIlxuXHRcdFx0KSB7XG5cdFx0XHRcdHRoaXMuYnV0dG9uQ29udGFpbmVyIS5jbGFzc0xpc3QuYWRkKFwiemVubW9kZS1idXR0b24tYXV0by1oaWRlXCIpO1xuXG5cdFx0XHRcdC8vIFNob3cgaW5pdGlhbCBoaWdobGlnaHQgYW5pbWF0aW9uIG9uIGZpcnN0IGVudHJ5IHRvIFplbiBtb2RlXG5cdFx0XHRcdGlmICghdGhpcy5faGFzU2hvd25Jbml0aWFsSGlnaGxpZ2h0KSB7XG5cdFx0XHRcdFx0dGhpcy5idXR0b25Db250YWluZXIhLmNsYXNzTGlzdC5hZGQoXG5cdFx0XHRcdFx0XHRcInplbm1vZGUtYnV0dG9uLWluaXRpYWwtaGlnaGxpZ2h0XCJcblx0XHRcdFx0XHQpO1xuXHRcdFx0XHRcdHRoaXMuX2hhc1Nob3duSW5pdGlhbEhpZ2hsaWdodCA9IHRydWU7XG5cblx0XHRcdFx0XHQvLyBSZW1vdmUgaGlnaGxpZ2h0IGNsYXNzIGFmdGVyIGFuaW1hdGlvbiBjb21wbGV0ZXMsIHRoZW4gZmFkZSBvdXRcblx0XHRcdFx0XHRjb25zdCB0aW1lb3V0MSA9IHdpbmRvdy5zZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdFx0XHRcdGlmICh0aGlzLmJ1dHRvbkNvbnRhaW5lcikge1xuXHRcdFx0XHRcdFx0XHR0aGlzLmJ1dHRvbkNvbnRhaW5lci5jbGFzc0xpc3QucmVtb3ZlKFxuXHRcdFx0XHRcdFx0XHRcdFwiemVubW9kZS1idXR0b24taW5pdGlhbC1oaWdobGlnaHRcIlxuXHRcdFx0XHRcdFx0XHQpO1xuXHRcdFx0XHRcdFx0XHQvLyBTbWFsbCBkZWxheSBiZWZvcmUgZmFkaW5nIG91dFxuXHRcdFx0XHRcdFx0XHRjb25zdCB0aW1lb3V0MiA9IHdpbmRvdy5zZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdFx0XHRcdFx0XHRpZiAodGhpcy5idXR0b25Db250YWluZXIpIHtcblx0XHRcdFx0XHRcdFx0XHRcdHRoaXMuYnV0dG9uQ29udGFpbmVyLmNsYXNzTGlzdC5hZGQoXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFwiemVubW9kZS1idXR0b24tZmFkZS1vdXRcIlxuXHRcdFx0XHRcdFx0XHRcdFx0KTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdH0sIDMwMCk7XG5cdFx0XHRcdFx0XHRcdHRoaXMuX2hpZ2hsaWdodFRpbWVvdXRzLnB1c2godGltZW91dDIpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0sIDE1MDApO1xuXHRcdFx0XHRcdHRoaXMuX2hpZ2hsaWdodFRpbWVvdXRzLnB1c2godGltZW91dDEpO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0aGlzLmJ1dHRvbkNvbnRhaW5lciEuY2xhc3NMaXN0LnJlbW92ZShcblx0XHRcdFx0XHRcInplbm1vZGUtYnV0dG9uLWF1dG8taGlkZVwiXG5cdFx0XHRcdCk7XG5cdFx0XHRcdHRoaXMuYnV0dG9uQ29udGFpbmVyIS5jbGFzc0xpc3QucmVtb3ZlKFxuXHRcdFx0XHRcdFwiemVubW9kZS1idXR0b24taW5pdGlhbC1oaWdobGlnaHRcIlxuXHRcdFx0XHQpO1xuXHRcdFx0XHR0aGlzLmJ1dHRvbkNvbnRhaW5lciEuY2xhc3NMaXN0LnJlbW92ZShcblx0XHRcdFx0XHRcInplbm1vZGUtYnV0dG9uLWZhZGUtb3V0XCJcblx0XHRcdFx0KTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gQWRqdXN0IHBvc2l0aW9uIHdoZW4gYnV0dG9uIGJlY29tZXMgdmlzaWJsZVxuXHRcdFx0dGhpcy5hZGp1c3RCdXR0b25Qb3NpdGlvbigpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRpZiAodGhpcy5oYXNCdXR0b24pIHtcblx0XHRcdFx0dGhpcy5idXR0b25Db250YWluZXIhLmNsYXNzTGlzdC5yZW1vdmUoXG5cdFx0XHRcdFx0XCJ6ZW5tb2RlLWJ1dHRvbi12aXNpYmxlXCJcblx0XHRcdFx0KTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogSGVscGVyIGZ1bmN0aW9uIHRvIGdldCB0aGUgdGFiIGNvbnRhaW5lciBmcm9tIGEgd29ya3NwYWNlIGxlYWYuXG5cdCAqIFJldHVybnMgbnVsbCBpZiB0aGUgbGVhZiBkb2Vzbid0IGhhdmUgYSB2YWxpZCBjb250YWluZXIgb3IgdGFiIGNvbnRhaW5lci5cblx0ICovXG5cdHByaXZhdGUgZ2V0VGFiQ29udGFpbmVyRnJvbUxlYWYoXG5cdFx0bGVhZjogV29ya3NwYWNlTGVhZiB8IG51bGxcblx0KTogSFRNTEVsZW1lbnQgfCBudWxsIHtcblx0XHRpZiAoIWxlYWYpIHJldHVybiBudWxsO1xuXG5cdFx0Ly8gRmluZCB0aGUgd29ya3NwYWNlLXRhYnMgY29udGFpbmVyIHRoYXQgaG9sZHMgdGhlIGxlYWZcblx0XHQvLyBOb3RlOiBjb250YWluZXJFbCBpcyBhbiBpbnRlcm5hbCBPYnNpZGlhbiBBUEkgcHJvcGVydHksIG5vdCBleHBvc2VkIGluIHB1YmxpYyB0eXBlc1xuXHRcdGludGVyZmFjZSBXb3Jrc3BhY2VMZWFmV2l0aENvbnRhaW5lciB7XG5cdFx0XHRjb250YWluZXJFbD86IEhUTUxFbGVtZW50O1xuXHRcdH1cblx0XHRjb25zdCBsZWFmV2l0aENvbnRhaW5lciA9IGxlYWYgYXMgV29ya3NwYWNlTGVhZldpdGhDb250YWluZXI7XG5cdFx0Y29uc3QgbGVhZkNvbnRhaW5lciA9IGxlYWZXaXRoQ29udGFpbmVyLmNvbnRhaW5lckVsID8/IG51bGw7XG5cdFx0aWYgKCFsZWFmQ29udGFpbmVyKSByZXR1cm4gbnVsbDtcblxuXHRcdGNvbnN0IHRhYkNvbnRhaW5lciA9IGxlYWZDb250YWluZXIuY2xvc2VzdChcIi53b3Jrc3BhY2UtdGFic1wiKTtcblx0XHRpZiAoIXRhYkNvbnRhaW5lciB8fCAhKHRhYkNvbnRhaW5lciBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSlcblx0XHRcdHJldHVybiBudWxsO1xuXG5cdFx0cmV0dXJuIHRhYkNvbnRhaW5lcjtcblx0fVxuXG5cdC8qKlxuXHQgKiBGaW5kcyBhbmQgcmV2ZWFscyBhIHBpbm5lZCB0YWIgaWYgb25lIGV4aXN0cy5cblx0ICogVGhpcyBzaG91bGQgYmUgY2FsbGVkIEJFRk9SRSBlbnRlcmluZyB6ZW4gbW9kZSB0byBwcmV2ZW50IG5ldyB0YWJzIGZyb20gYmVpbmcgY3JlYXRlZC5cblx0ICovXG5cdHByaXZhdGUgYXN5bmMgcmV2ZWFsUGlubmVkVGFiSWZFeGlzdHMoKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0dHJ5IHtcblx0XHRcdC8vIFVzZSBPYnNpZGlhbiBBUEkgdG8gZmluZCBwaW5uZWQgbGVhdmVzXG5cdFx0XHQvLyBDaGVjayBhbGwgbWFya2Rvd24gbGVhdmVzIGFuZCBzZWUgaWYgYW55IGFyZSBwaW5uZWRcblx0XHRcdGNvbnN0IG1hcmtkb3duTGVhdmVzID1cblx0XHRcdFx0dGhpcy5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZShcIm1hcmtkb3duXCIpO1xuXG5cdFx0XHQvLyBDaGVjayBlYWNoIGxlYWYgdG8gc2VlIGlmIGl0J3MgcGlubmVkXG5cdFx0XHQvLyBQaW5uZWQgc3RhdGUgbWlnaHQgYmUgaW4gdGhlIHZpZXcgc3RhdGUgb3IgbGVhZiBwcm9wZXJ0aWVzXG5cdFx0XHRmb3IgKGNvbnN0IGxlYWYgb2YgbWFya2Rvd25MZWF2ZXMpIHtcblx0XHRcdFx0aW50ZXJmYWNlIFdvcmtzcGFjZUxlYWZXaXRoUGlubmVkIHtcblx0XHRcdFx0XHRwaW5uZWQ/OiBib29sZWFuO1xuXHRcdFx0XHRcdHZpZXc/OiB7XG5cdFx0XHRcdFx0XHRnZXRTdGF0ZT86ICgpID0+IHsgcGlubmVkPzogYm9vbGVhbiB9O1xuXHRcdFx0XHRcdH07XG5cdFx0XHRcdH1cblx0XHRcdFx0Y29uc3QgbGVhZldpdGhQaW5uZWQgPSBsZWFmIGFzIFdvcmtzcGFjZUxlYWZXaXRoUGlubmVkO1xuXG5cdFx0XHRcdC8vIFRyeSBtdWx0aXBsZSB3YXlzIHRvIGNoZWNrIGlmIGxlYWYgaXMgcGlubmVkXG5cdFx0XHRcdGxldCBpc1Bpbm5lZCA9IGZhbHNlO1xuXHRcdFx0XHRpZiAobGVhZldpdGhQaW5uZWQucGlubmVkID09PSB0cnVlKSB7XG5cdFx0XHRcdFx0aXNQaW5uZWQgPSB0cnVlO1xuXHRcdFx0XHR9IGVsc2UgaWYgKGxlYWZXaXRoUGlubmVkLnZpZXc/LmdldFN0YXRlKSB7XG5cdFx0XHRcdFx0Y29uc3Qgc3RhdGUgPSBsZWFmV2l0aFBpbm5lZC52aWV3LmdldFN0YXRlKCk7XG5cdFx0XHRcdFx0aWYgKChzdGF0ZSBhcyB7IHBpbm5lZD86IGJvb2xlYW4gfSkucGlubmVkID09PSB0cnVlKSB7XG5cdFx0XHRcdFx0XHRpc1Bpbm5lZCA9IHRydWU7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gQWxzbyBjaGVjayB0aGUgRE9NIGZvciBwaW5uZWQgaW5kaWNhdG9yIG9uIHRoaXMgbGVhZidzIGNvbnRhaW5lclxuXHRcdFx0XHRpbnRlcmZhY2UgV29ya3NwYWNlTGVhZldpdGhDb250YWluZXIge1xuXHRcdFx0XHRcdGNvbnRhaW5lckVsPzogSFRNTEVsZW1lbnQ7XG5cdFx0XHRcdH1cblx0XHRcdFx0Y29uc3QgbGVhZldpdGhDb250YWluZXIgPSBsZWFmIGFzIFdvcmtzcGFjZUxlYWZXaXRoQ29udGFpbmVyO1xuXHRcdFx0XHRpZiAobGVhZldpdGhDb250YWluZXIuY29udGFpbmVyRWwpIHtcblx0XHRcdFx0XHRjb25zdCB0YWJIZWFkZXIgPVxuXHRcdFx0XHRcdFx0bGVhZldpdGhDb250YWluZXIuY29udGFpbmVyRWwucXVlcnlTZWxlY3Rvcihcblx0XHRcdFx0XHRcdFx0XCIud29ya3NwYWNlLXRhYi1oZWFkZXJcIlxuXHRcdFx0XHRcdFx0KTtcblx0XHRcdFx0XHRpZiAodGFiSGVhZGVyICYmIHRhYkhlYWRlciBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSB7XG5cdFx0XHRcdFx0XHQvLyBDaGVjayBpZiB0YWIgaGFzIHBpbm5lZCBjbGFzcyBvciBhdHRyaWJ1dGVcblx0XHRcdFx0XHRcdGlmIChcblx0XHRcdFx0XHRcdFx0dGFiSGVhZGVyLmNsYXNzTGlzdC5jb250YWlucyhcImlzLXBpbm5lZFwiKSB8fFxuXHRcdFx0XHRcdFx0XHR0YWJIZWFkZXIuaGFzQXR0cmlidXRlKFwiZGF0YS1waW5uZWRcIilcblx0XHRcdFx0XHRcdCkge1xuXHRcdFx0XHRcdFx0XHRpc1Bpbm5lZCA9IHRydWU7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0aWYgKGlzUGlubmVkKSB7XG5cdFx0XHRcdFx0Ly8gRXhwbGljaXRseSByZXZlYWwgdGhpcyBsZWFmIHRvIG1ha2UgaXQgYWN0aXZlXG5cdFx0XHRcdFx0dm9pZCB0aGlzLmFwcC53b3Jrc3BhY2UucmV2ZWFsTGVhZihsZWFmKTtcblx0XHRcdFx0XHQvLyBXYWl0IGZvciB0aGUgcmV2ZWFsIHRvIHRha2UgZWZmZWN0IHVzaW5nIHJlcXVlc3RBbmltYXRpb25GcmFtZSBmb3IgYmV0dGVyIHRpbWluZ1xuXHRcdFx0XHRcdGF3YWl0IG5ldyBQcm9taXNlPHZvaWQ+KChyZXNvbHZlKSA9PiB7XG5cdFx0XHRcdFx0XHRyZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4ge1xuXHRcdFx0XHRcdFx0XHRyZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4gcmVzb2x2ZSgpKTtcblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0gY2F0Y2gge1xuXHRcdFx0Ly8gU2lsZW50bHkgaGFuZGxlIGVycm9yc1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBIZWxwZXIgZnVuY3Rpb24gdG8gZmluZCB0aGUgYWN0aXZlIHRhYiBjb250YWluZXIgYnkgY2hlY2tpbmcgdGhlIERPTS5cblx0ICogTG9va3MgZm9yIHRhYnMgd2l0aCB0aGUgJ2lzLWFjdGl2ZScgY2xhc3Mgb3IgdmlzaWJsZSBhY3RpdmUgdGFiIGhlYWRlcnMuXG5cdCAqL1xuXHRwcml2YXRlIGZpbmRBY3RpdmVUYWJDb250YWluZXJGcm9tRE9NKCk6IEhUTUxFbGVtZW50IHwgbnVsbCB7XG5cdFx0Ly8gVHJ5IHRvIGZpbmQgYW4gYWN0aXZlIHRhYiBoZWFkZXJcblx0XHRjb25zdCBhY3RpdmVUYWJIZWFkZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuXHRcdFx0XCIud29ya3NwYWNlLXRhYi1oZWFkZXIuaXMtYWN0aXZlXCJcblx0XHQpO1xuXHRcdGlmIChhY3RpdmVUYWJIZWFkZXIpIHtcblx0XHRcdGNvbnN0IHRhYkNvbnRhaW5lciA9IGFjdGl2ZVRhYkhlYWRlci5jbG9zZXN0KFwiLndvcmtzcGFjZS10YWJzXCIpO1xuXHRcdFx0aWYgKHRhYkNvbnRhaW5lciAmJiB0YWJDb250YWluZXIgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkge1xuXHRcdFx0XHRyZXR1cm4gdGFiQ29udGFpbmVyO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIEZhbGxiYWNrOiBmaW5kIGFueSB2aXNpYmxlIHRhYiBjb250YWluZXIgKHByZWZlciB0aGUgZmlyc3Qgb25lKVxuXHRcdC8vIFRoaXMgaGFuZGxlcyBlZGdlIGNhc2VzIHdoZXJlIG5vIHRhYiBpcyBtYXJrZWQgYXMgYWN0aXZlXG5cdFx0Y29uc3QgYWxsVGFiQ29udGFpbmVycyA9IEFycmF5LmZyb20oXG5cdFx0XHRkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLndvcmtzcGFjZS10YWJzXCIpXG5cdFx0KTtcblx0XHRmb3IgKGNvbnN0IGNvbnRhaW5lciBvZiBhbGxUYWJDb250YWluZXJzKSB7XG5cdFx0XHRjb25zdCBlbCA9IGNvbnRhaW5lciBhcyBIVE1MRWxlbWVudDtcblx0XHRcdC8vIENoZWNrIGlmIHRoZSBjb250YWluZXIgaXMgdmlzaWJsZSAobm90IGFscmVhZHkgaGlkZGVuKVxuXHRcdFx0aWYgKFxuXHRcdFx0XHRlbC5vZmZzZXRQYXJlbnQgIT09IG51bGwgJiZcblx0XHRcdFx0IWVsLmNsYXNzTGlzdC5jb250YWlucyhcInplbm1vZGUtdGFiLWhpZGRlblwiKVxuXHRcdFx0KSB7XG5cdFx0XHRcdHJldHVybiBlbDtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4gbnVsbDtcblx0fVxuXG5cdC8qKlxuXHQgKiBVcGRhdGVzIGZvY3VzZWQgZmlsZSBtb2RlIHZpc2liaWxpdHkuXG5cdCAqIFdoZW4gZW5hYmxlZCwgaGlkZXMgYWxsIHdvcmtzcGFjZSB0YWIgY29udGFpbmVycyBleGNlcHQgdGhlIG9uZSBjb250YWluaW5nIHRoZSBhY3RpdmUgbGVhZixcblx0ICogc2hvd2luZyBvbmx5IHRoZSBjdXJyZW50bHkgZm9jdXNlZCBmaWxlLiBXaGVuIGRpc2FibGVkLCByZXN0b3JlcyBhbGwgdGFiIGNvbnRhaW5lcnMuXG5cdCAqIFVzZXMgbXVsdGlwbGUgZmFsbGJhY2sgbWV0aG9kcyB0byBoYW5kbGUgcGlubmVkIHRhYnMgYW5kIGVkZ2UgY2FzZXMuXG5cdCAqL1xuXHRhc3luYyB1cGRhdGVGb2N1c2VkRmlsZU1vZGUoKSB7XG5cdFx0aWYgKCF0aGlzLnNldHRpbmdzLnplbk1vZGUgfHwgIXRoaXMuc2V0dGluZ3MuZm9jdXNlZEZpbGVNb2RlKSB7XG5cdFx0XHQvLyBSZXN0b3JlIGFsbCB0YWIgY29udGFpbmVycyB3aGVuIGZvY3VzZWQgZmlsZSBtb2RlIGlzIG9mZlxuXHRcdFx0Y29uc3QgYWxsVGFiQ29udGFpbmVycyA9XG5cdFx0XHRcdGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIud29ya3NwYWNlLXRhYnNcIik7XG5cdFx0XHRhbGxUYWJDb250YWluZXJzLmZvckVhY2goKGNvbnRhaW5lcikgPT4ge1xuXHRcdFx0XHRjb25zdCBlbCA9IGNvbnRhaW5lciBhcyBIVE1MRWxlbWVudDtcblx0XHRcdFx0ZWwuY2xhc3NMaXN0LnJlbW92ZShcInplbm1vZGUtdGFiLWhpZGRlblwiKTtcblx0XHRcdFx0ZWwuY2xhc3NMaXN0LnJlbW92ZShcInplbm1vZGUtdGFiLWFjdGl2ZVwiKTtcblx0XHRcdFx0Ly8gQ2xlYXIgYW55IGlubGluZSBzdHlsZXMgdG8gcmVzdG9yZSBkZWZhdWx0IHN0YXRlXG5cdFx0XHRcdHNldENzc1Byb3BzKGVsLCB7IGRpc3BsYXk6IFwiXCIsIHdpZHRoOiBcIlwiLCBmbGV4OiBcIlwiIH0pO1xuXHRcdFx0fSk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Ly8gQ1JJVElDQUw6IEJlZm9yZSBjYWxsaW5nIGdldExlYWYoZmFsc2UpLCBjaGVjayBmb3IgcGlubmVkIHRhYnMgYW5kIHJldmVhbCB0aGVtXG5cdFx0Ly8gVGhpcyBwcmV2ZW50cyBnZXRMZWFmKGZhbHNlKSBmcm9tIGNyZWF0aW5nIGEgbmV3IHRhYlxuXHRcdGF3YWl0IHRoaXMucmV2ZWFsUGlubmVkVGFiSWZFeGlzdHMoKTtcblxuXHRcdGNvbnN0IGFsbFRhYkNvbnRhaW5lcnMgPSBBcnJheS5mcm9tKFxuXHRcdFx0ZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi53b3Jrc3BhY2UtdGFic1wiKVxuXHRcdCk7XG5cblx0XHQvLyBUcnkgbXVsdGlwbGUgbWV0aG9kcyB0byBmaW5kIHRoZSBhY3RpdmUgdGFiIGNvbnRhaW5lclxuXHRcdGxldCBhY3RpdmVUYWJDb250YWluZXI6IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGw7XG5cblx0XHQvLyBNZXRob2QgMDogUFJJT1JJVFkgLSBDaGVjayBBTEwgY29udGFpbmVycyBmb3IgcGlubmVkIHRhYnMgRklSU1Rcblx0XHQvLyBJZiBhIHBpbm5lZCB0YWIgZXhpc3RzLCB3ZSBNVVNUIHVzZSBpdHMgY29udGFpbmVyLCBub3QgdGhlIFwiYWN0aXZlXCIgb25lXG5cdFx0Zm9yIChjb25zdCBjb250YWluZXIgb2YgYWxsVGFiQ29udGFpbmVycykge1xuXHRcdFx0Y29uc3QgZWwgPSBjb250YWluZXIgYXMgSFRNTEVsZW1lbnQ7XG5cdFx0XHQvLyBDaGVjayBhbGwgdGFiIGhlYWRlcnMgaW4gdGhpcyBjb250YWluZXIgZm9yIHBpbm5lZCBzdGF0ZVxuXHRcdFx0Ly8gVXNlIFNUUklDVCBjaGVja3Mgb25seSAtIGNsYXNzIFwiaXMtcGlubmVkXCIgb3IgZGF0YS1waW5uZWQ9XCJ0cnVlXCIgYXR0cmlidXRlXG5cdFx0XHRjb25zdCBwaW5uZWRUYWJzID0gQXJyYXkuZnJvbShcblx0XHRcdFx0ZWwucXVlcnlTZWxlY3RvckFsbChcblx0XHRcdFx0XHRcIi53b3Jrc3BhY2UtdGFiLWhlYWRlci5pcy1waW5uZWQsIC53b3Jrc3BhY2UtdGFiLWhlYWRlcltkYXRhLXBpbm5lZD0ndHJ1ZSddXCJcblx0XHRcdFx0KVxuXHRcdFx0KTtcblxuXHRcdFx0aWYgKHBpbm5lZFRhYnMubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRhY3RpdmVUYWJDb250YWluZXIgPSBlbDtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gTWV0aG9kIDE6IFVzZSBnZXRNb3N0UmVjZW50TGVhZigpIGZvciBub24tcGlubmVkIHRhYnMgKHNhZmVyIHRoYW4gZ2V0TGVhZihmYWxzZSkpXG5cdFx0Ly8gVGhpcyBhdm9pZHMgY3JlYXRpbmcgbmV3IHRhYnMgd2hpbGUgc3RpbGwgZmluZGluZyB0aGUgYWN0aXZlIHRhYlxuXHRcdGlmICghYWN0aXZlVGFiQ29udGFpbmVyKSB7XG5cdFx0XHRjb25zdCBtb3N0UmVjZW50TGVhZiA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRNb3N0UmVjZW50TGVhZigpO1xuXHRcdFx0aWYgKG1vc3RSZWNlbnRMZWFmKSB7XG5cdFx0XHRcdGFjdGl2ZVRhYkNvbnRhaW5lciA9XG5cdFx0XHRcdFx0dGhpcy5nZXRUYWJDb250YWluZXJGcm9tTGVhZihtb3N0UmVjZW50TGVhZik7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gTWV0aG9kIDFiOiBGYWxsYmFjayB0byBET00tYmFzZWQgZGV0ZWN0aW9uIGlmIGdldE1vc3RSZWNlbnRMZWFmKCkgZmFpbGVkXG5cdFx0aWYgKCFhY3RpdmVUYWJDb250YWluZXIpIHtcblx0XHRcdGNvbnN0IGFjdGl2ZVRhYkZyb21ET00gPSB0aGlzLmZpbmRBY3RpdmVUYWJDb250YWluZXJGcm9tRE9NKCk7XG5cdFx0XHRpZiAoYWN0aXZlVGFiRnJvbURPTSkge1xuXHRcdFx0XHRhY3RpdmVUYWJDb250YWluZXIgPSBhY3RpdmVUYWJGcm9tRE9NO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIElmIHdlIHN0aWxsIGNhbid0IGZpbmQgYSB2YWxpZCB0YWIgY29udGFpbmVyLCBnaXZlIHVwXG5cdFx0aWYgKCFhY3RpdmVUYWJDb250YWluZXIpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHQvLyBIaWRlIGFsbCB3b3Jrc3BhY2UtdGFicyBjb250YWluZXJzIGV4Y2VwdCB0aGUgb25lIGNvbnRhaW5pbmcgdGhlIGFjdGl2ZSBsZWFmXG5cdFx0YWxsVGFiQ29udGFpbmVycy5mb3JFYWNoKCh0YWJDb250YWluZXIpID0+IHtcblx0XHRcdGNvbnN0IGVsID0gdGFiQ29udGFpbmVyIGFzIEhUTUxFbGVtZW50O1xuXHRcdFx0aWYgKHRhYkNvbnRhaW5lciA9PT0gYWN0aXZlVGFiQ29udGFpbmVyKSB7XG5cdFx0XHRcdC8vIFNob3cgYW5kIGV4cGFuZCB0aGUgYWN0aXZlIHRhYiBjb250YWluZXJcblx0XHRcdFx0ZWwuY2xhc3NMaXN0LnJlbW92ZShcInplbm1vZGUtdGFiLWhpZGRlblwiKTtcblx0XHRcdFx0c2V0Q3NzUHJvcHMoZWwsIHtcblx0XHRcdFx0XHRkaXNwbGF5OiBcIlwiLFxuXHRcdFx0XHRcdHdpZHRoOiBcIjEwMCVcIixcblx0XHRcdFx0XHRmbGV4OiBcIjEgMSAxMDAlXCIsXG5cdFx0XHRcdH0pO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Ly8gSGlkZSBub24tYWN0aXZlIHRhYiBjb250YWluZXJzXG5cdFx0XHRcdGVsLmNsYXNzTGlzdC5hZGQoXCJ6ZW5tb2RlLXRhYi1oaWRkZW5cIik7XG5cdFx0XHRcdHNldENzc1Byb3BzKGVsLCB7IGRpc3BsYXk6IFwibm9uZVwiIH0pO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG5cblx0LyoqXG5cdCAqIFRvZ2dsZXMgemVuIG1vZGUgb24gb3Igb2ZmLlxuXHQgKiBIYW5kbGVzIGZ1bGxzY3JlZW4gZW50cnkvZXhpdCBpZiBlbmFibGVkLCB1cGRhdGVzIHNldHRpbmdzLCBhbmQgcmVmcmVzaGVzIHRoZSBVSS5cblx0ICogSW5jbHVkZXMgZ3VhcmQgYWdhaW5zdCBjb25jdXJyZW50IGludm9jYXRpb25zIHRvIHByZXZlbnQgcmFjZSBjb25kaXRpb25zLlxuXHQgKi9cblx0YXN5bmMgdG9nZ2xlWmVuTW9kZSgpIHtcblx0XHQvLyBHdWFyZCBhZ2FpbnN0IGNvbmN1cnJlbnQgaW52b2NhdGlvbnNcblx0XHRpZiAodGhpcy5faXNUb2dnbGluZ1plbikge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdHRoaXMuX2lzVG9nZ2xpbmdaZW4gPSB0cnVlO1xuXG5cdFx0dHJ5IHtcblx0XHRcdGNvbnN0IGVudGVyaW5nWmVuTW9kZSA9ICF0aGlzLnNldHRpbmdzLnplbk1vZGU7XG5cblx0XHRcdC8vIFJlc2V0IGhpZ2hsaWdodCBmbGFnIHdoZW4gZXhpdGluZyBaZW4gbW9kZVxuXHRcdFx0aWYgKCFlbnRlcmluZ1plbk1vZGUpIHtcblx0XHRcdFx0dGhpcy5faGFzU2hvd25Jbml0aWFsSGlnaGxpZ2h0ID0gZmFsc2U7XG5cdFx0XHR9XG5cblx0XHRcdGlmIChlbnRlcmluZ1plbk1vZGUpIHtcblx0XHRcdFx0Ly8gQ1JJVElDQUw6IElmIGZvY3VzZWQgZmlsZSBtb2RlIGlzIGVuYWJsZWQsIGZpbmQgYW5kIHJldmVhbCBwaW5uZWQgdGFiIEJFRk9SRSBhbnl0aGluZyBlbHNlXG5cdFx0XHRcdC8vIFRoaXMgcHJldmVudHMgT2JzaWRpYW4gZnJvbSBjcmVhdGluZyBhIG5ldyB0YWIgd2hlbiBnZXRMZWFmKGZhbHNlKSBpcyBjYWxsZWRcblx0XHRcdFx0aWYgKHRoaXMuc2V0dGluZ3MuZm9jdXNlZEZpbGVNb2RlKSB7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5yZXZlYWxQaW5uZWRUYWJJZkV4aXN0cygpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gRW50ZXIgZnVsbHNjcmVlbiBmaXJzdCBpZiBzZXR0aW5nIGlzIGVuYWJsZWRcblx0XHRcdFx0aWYgKFxuXHRcdFx0XHRcdHRoaXMuc2V0dGluZ3MuZnVsbHNjcmVlbiAmJlxuXHRcdFx0XHRcdGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5yZXF1ZXN0RnVsbHNjcmVlblxuXHRcdFx0XHQpIHtcblx0XHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdFx0YXdhaXQgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnJlcXVlc3RGdWxsc2NyZWVuKCk7XG5cdFx0XHRcdFx0XHQvLyBXYWl0IGZvciBuZXh0IGZyYW1lIHRvIGVuc3VyZSBmdWxsc2NyZWVuIHRyYW5zaXRpb24gaXMgc21vb3RoXG5cdFx0XHRcdFx0XHRhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT5cblx0XHRcdFx0XHRcdFx0cmVxdWVzdEFuaW1hdGlvbkZyYW1lKHJlc29sdmUpXG5cdFx0XHRcdFx0XHQpO1xuXHRcdFx0XHRcdH0gY2F0Y2gge1xuXHRcdFx0XHRcdFx0Ly8gRnVsbHNjcmVlbiBtaWdodCBmYWlsIChlLmcuLCB1c2VyIGNhbmNlbGxlZCksIGNvbnRpbnVlIGFueXdheVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIFVwZGF0ZSB6ZW4gbW9kZSBzdGF0ZSBhZnRlciBmdWxsc2NyZWVuIG9wZXJhdGlvbiBjb21wbGV0ZXNcblx0XHRcdFx0dGhpcy5zZXR0aW5ncy56ZW5Nb2RlID0gdHJ1ZTtcblx0XHRcdFx0YXdhaXQgdGhpcy5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0dGhpcy5yZWZyZXNoKCk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQvLyBFeGl0IGZ1bGxzY3JlZW4gZmlyc3QgaWYgYWN0aXZlXG5cdFx0XHRcdGlmIChkb2N1bWVudC5mdWxsc2NyZWVuRWxlbWVudCAmJiBkb2N1bWVudC5leGl0RnVsbHNjcmVlbikge1xuXHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRhd2FpdCBkb2N1bWVudC5leGl0RnVsbHNjcmVlbigpO1xuXHRcdFx0XHRcdFx0Ly8gV2FpdCBmb3IgRE9NIHVwZGF0ZXMgdG8gY29tcGxldGVcblx0XHRcdFx0XHRcdGF3YWl0IG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PlxuXHRcdFx0XHRcdFx0XHRyZXF1ZXN0QW5pbWF0aW9uRnJhbWUocmVzb2x2ZSlcblx0XHRcdFx0XHRcdCk7XG5cdFx0XHRcdFx0fSBjYXRjaCB7XG5cdFx0XHRcdFx0XHQvLyBGdWxsc2NyZWVuIGV4aXQgbWlnaHQgZmFpbCwgY29udGludWUgYW55d2F5XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gVXBkYXRlIHplbiBtb2RlIHN0YXRlIGFmdGVyIGZ1bGxzY3JlZW4gb3BlcmF0aW9uIGNvbXBsZXRlc1xuXHRcdFx0XHR0aGlzLnNldHRpbmdzLnplbk1vZGUgPSBmYWxzZTtcblx0XHRcdFx0YXdhaXQgdGhpcy5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0dGhpcy5yZWZyZXNoKCk7XG5cdFx0XHR9XG5cdFx0fSBmaW5hbGx5IHtcblx0XHRcdC8vIEFsd2F5cyBjbGVhciB0aGUgbG9jaywgZXZlbiBpZiBhbiBlcnJvciBvY2N1cnNcblx0XHRcdHRoaXMuX2lzVG9nZ2xpbmdaZW4gPSBmYWxzZTtcblx0XHR9XG5cdH1cbn1cbiIsICIvKipcbiAqIFNldHRpbmdzIGludGVyZmFjZSBmb3IgdGhlIFplbiBNb2RlIHBsdWdpbi5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBaZW5Nb2RlU2V0dGluZ3Mge1xuXHQvKiogV2hldGhlciB6ZW4gbW9kZSBpcyBjdXJyZW50bHkgYWN0aXZlLiAqL1xuXHR6ZW5Nb2RlOiBib29sZWFuO1xuXHQvKiogV2hldGhlciB0aGUgbGVmdCBzaWRlYmFyIHdhcyBjb2xsYXBzZWQgYmVmb3JlIGVudGVyaW5nIHplbiBtb2RlLiAqL1xuXHRsZWZ0U2lkZWJhcjogYm9vbGVhbjtcblx0LyoqIFdoZXRoZXIgdGhlIHJpZ2h0IHNpZGViYXIgd2FzIGNvbGxhcHNlZCBiZWZvcmUgZW50ZXJpbmcgemVuIG1vZGUuICovXG5cdHJpZ2h0U2lkZWJhcjogYm9vbGVhbjtcblx0LyoqIFdoZXRoZXIgdG8gYXV0b21hdGljYWxseSBlbnRlciBmdWxsc2NyZWVuIHdoZW4gZW5hYmxpbmcgemVuIG1vZGUuICovXG5cdGZ1bGxzY3JlZW46IGJvb2xlYW47XG5cdC8qKiBXaGVuIHRvIHNob3cgdGhlIHplbiBtb2RlIGV4aXQgYnV0dG9uLiAqL1xuXHRleGl0QnV0dG9uVmlzaWJpbGl0eTogXCJtb2JpbGUtb25seVwiIHwgXCJhbHdheXNcIiB8IFwibmV2ZXJcIjtcblx0LyoqIFdoZXRoZXIgdG8gYXV0by1oaWRlIHRoZSBleGl0IGJ1dHRvbiBvbiBkZXNrdG9wIChyZXZlYWxzIG9uIGhvdmVyKS4gKi9cblx0YXV0b0hpZGVCdXR0b25PbkRlc2t0b3A6IGJvb2xlYW47XG5cdC8qKiBXaGV0aGVyIHRvIGhpZGUgcHJvcGVydGllcyB3aGVuIHplbiBtb2RlIGlzIGFjdGl2ZS4gKi9cblx0aGlkZVByb3BlcnRpZXM6IGJvb2xlYW47XG5cdC8qKiBXaGV0aGVyIHRvIGhpZGUgdGhlIGlubGluZSB0aXRsZSAobm90ZSB0aXRsZSkgd2hlbiB6ZW4gbW9kZSBpcyBhY3RpdmUuICovXG5cdGhpZGVJbmxpbmVUaXRsZTogYm9vbGVhbjtcblx0LyoqIFRvcCBwYWRkaW5nIGluIHBpeGVscyAoMC0xMDApLiAqL1xuXHR0b3BQYWRkaW5nOiBudW1iZXI7XG5cdC8qKiBCb3R0b20gcGFkZGluZyBpbiBwaXhlbHMgKDAtMTAwKS4gKi9cblx0Ym90dG9tUGFkZGluZzogbnVtYmVyO1xuXHQvKiogV2hldGhlciB0byBzaG93IG9ubHkgdGhlIGFjdGl2ZSBmaWxlLCBoaWRpbmcgYWxsIG90aGVyIHBhbmVzLiAqL1xuXHRmb2N1c2VkRmlsZU1vZGU6IGJvb2xlYW47XG5cdC8qKiBXaGV0aGVyIHRvIGhpZGUgdGhlIHN0YXR1cyBiYXIgd2hlbiB6ZW4gbW9kZSBpcyBhY3RpdmUuICovXG5cdGhpZGVTdGF0dXNCYXI6IGJvb2xlYW47XG59XG5cbi8qKlxuICogRGVmYXVsdCBzZXR0aW5ncyBmb3IgdGhlIFplbiBNb2RlIHBsdWdpbi5cbiAqL1xuZXhwb3J0IGNvbnN0IERFRkFVTFRfU0VUVElOR1M6IFplbk1vZGVTZXR0aW5ncyA9IHtcblx0emVuTW9kZTogZmFsc2UsXG5cdGxlZnRTaWRlYmFyOiBmYWxzZSxcblx0cmlnaHRTaWRlYmFyOiBmYWxzZSxcblx0ZnVsbHNjcmVlbjogZmFsc2UsXG5cdGV4aXRCdXR0b25WaXNpYmlsaXR5OiBcImFsd2F5c1wiLFxuXHRhdXRvSGlkZUJ1dHRvbk9uRGVza3RvcDogZmFsc2UsXG5cdGhpZGVQcm9wZXJ0aWVzOiBmYWxzZSxcblx0aGlkZUlubGluZVRpdGxlOiBmYWxzZSxcblx0dG9wUGFkZGluZzogMCxcblx0Ym90dG9tUGFkZGluZzogMCxcblx0Zm9jdXNlZEZpbGVNb2RlOiBmYWxzZSxcblx0aGlkZVN0YXR1c0JhcjogZmFsc2UsXG59O1xuIiwgImltcG9ydCB7IEFwcCwgUGx1Z2luU2V0dGluZ1RhYiB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHsgY3JlYXRlU2V0dGluZ3NHcm91cCB9IGZyb20gXCIuL3V0aWxzL3NldHRpbmdzLWNvbXBhdFwiO1xuaW1wb3J0IHR5cGUgWmVuTW9kZSBmcm9tIFwiLi9tYWluXCI7XG5cbi8qKlxuICogU2V0dGluZ3MgdGFiIGZvciB0aGUgWmVuIE1vZGUgcGx1Z2luLlxuICogUHJvdmlkZXMgVUkgZm9yIGNvbmZpZ3VyaW5nIGFsbCBwbHVnaW4gc2V0dGluZ3MuXG4gKi9cbmV4cG9ydCBjbGFzcyBaZW5Nb2RlU2V0dGluZ1RhYiBleHRlbmRzIFBsdWdpblNldHRpbmdUYWIge1xuXHRwbHVnaW46IFplbk1vZGU7XG5cdC8qKlxuXHQgKiBDcmVhdGVzIGEgbmV3IHNldHRpbmdzIHRhYiBpbnN0YW5jZS5cblx0ICogQHBhcmFtIGFwcCAtIFRoZSBPYnNpZGlhbiBhcHAgaW5zdGFuY2Vcblx0ICogQHBhcmFtIHBsdWdpbiAtIFRoZSBaZW4gTW9kZSBwbHVnaW4gaW5zdGFuY2Vcblx0ICovXG5cdGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IFplbk1vZGUpIHtcblx0XHRzdXBlcihhcHAsIHBsdWdpbik7XG5cdFx0dGhpcy5wbHVnaW4gPSBwbHVnaW47XG5cdH1cblxuXHQvKipcblx0ICogRGlzcGxheXMgdGhlIHNldHRpbmdzIHRhYiBVSS5cblx0ICogQ3JlYXRlcyBhbGwgc2V0dGluZyBjb250cm9scyBhbmQgcmVnaXN0ZXJzIGNoYW5nZSBoYW5kbGVycy5cblx0ICovXG5cdGRpc3BsYXkoKTogdm9pZCB7XG5cdFx0Y29uc3QgeyBjb250YWluZXJFbCB9ID0gdGhpcztcblxuXHRcdGNvbnRhaW5lckVsLmVtcHR5KCk7XG5cblx0XHQvLyBDcmVhdGUgc2V0dGluZ3MgZ3JvdXAgKG5vIGhlYWRpbmcgLSBhbGwgc2V0dGluZ3MgYXJlIGdlbmVyYWwpXG5cdFx0Y29uc3QgZ2VuZXJhbEdyb3VwID0gY3JlYXRlU2V0dGluZ3NHcm91cChcblx0XHRcdGNvbnRhaW5lckVsLFxuXHRcdFx0dW5kZWZpbmVkLFxuXHRcdFx0XCJ6ZW5tb2RlXCJcblx0XHQpO1xuXG5cdFx0Z2VuZXJhbEdyb3VwLmFkZFNldHRpbmcoKHNldHRpbmcpID0+IHtcblx0XHRcdHNldHRpbmdcblx0XHRcdFx0LnNldE5hbWUoXCJGdWxsIHNjcmVlblwiKVxuXHRcdFx0XHQuc2V0RGVzYyhcblx0XHRcdFx0XHRcIkF1dG9tYXRpY2FsbHkgZW50ZXIgZnVsbHNjcmVlbiB3aGVuIGVuYWJsaW5nIHplbiBtb2RlLlwiXG5cdFx0XHRcdClcblx0XHRcdFx0LmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxuXHRcdFx0XHRcdHRvZ2dsZVxuXHRcdFx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmZ1bGxzY3JlZW4pXG5cdFx0XHRcdFx0XHQub25DaGFuZ2UoKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmZ1bGxzY3JlZW4gPSB2YWx1ZTtcblx0XHRcdFx0XHRcdFx0dm9pZCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0XHRcdH0pXG5cdFx0XHRcdCk7XG5cdFx0fSk7XG5cblx0XHRnZW5lcmFsR3JvdXAuYWRkU2V0dGluZygoc2V0dGluZykgPT4ge1xuXHRcdFx0c2V0dGluZ1xuXHRcdFx0XHQuc2V0TmFtZShcIlNob3cgemVuIG1vZGUgZXhpdCBidXR0b25cIilcblx0XHRcdFx0LnNldERlc2MoXG5cdFx0XHRcdFx0XCJXaGVuIHRvIHNob3cgdGhlIGV4aXQgYnV0dG9uIGluIHplbiBtb2RlLiBZb3UgY2FuIGFsc28gZXhpdCB2aWEgdGhlIGNvbW1hbmQgcGFsZXR0ZSwgYnkgcHJlc3NpbmcgZXNjLCBvciBieSBhc3NpZ25pbmcgYSBob3RrZXkgdG8gdGhlICd0b2dnbGUgemVuIG1vZGUnIGNvbW1hbmQuXCJcblx0XHRcdFx0KVxuXHRcdFx0XHQuYWRkRHJvcGRvd24oKGRyb3Bkb3duKSA9PlxuXHRcdFx0XHRcdGRyb3Bkb3duXG5cdFx0XHRcdFx0XHQuYWRkT3B0aW9uKFwiYWx3YXlzXCIsIFwiQWx3YXlzIHNob3dcIilcblx0XHRcdFx0XHRcdC5hZGRPcHRpb24oXCJtb2JpbGUtb25seVwiLCBcIk1vYmlsZSBvbmx5XCIpXG5cdFx0XHRcdFx0XHQuYWRkT3B0aW9uKFwibmV2ZXJcIiwgXCJOZXZlciBzaG93XCIpXG5cdFx0XHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZXhpdEJ1dHRvblZpc2liaWxpdHkpXG5cdFx0XHRcdFx0XHQub25DaGFuZ2UoKHZhbHVlOiBzdHJpbmcpID0+IHtcblx0XHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuZXhpdEJ1dHRvblZpc2liaWxpdHkgPVxuXHRcdFx0XHRcdFx0XHRcdHZhbHVlIGFzIFwibW9iaWxlLW9ubHlcIiB8IFwiYWx3YXlzXCIgfCBcIm5ldmVyXCI7XG5cdFx0XHRcdFx0XHRcdHZvaWQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnJlZnJlc2goKTtcblx0XHRcdFx0XHRcdH0pXG5cdFx0XHRcdCk7XG5cdFx0fSk7XG5cblx0XHRnZW5lcmFsR3JvdXAuYWRkU2V0dGluZygoc2V0dGluZykgPT4ge1xuXHRcdFx0c2V0dGluZ1xuXHRcdFx0XHQuc2V0TmFtZShcIkF1dG8taGlkZSB6ZW4gbW9kZSBleGl0IGJ1dHRvbiBvbiBkZXNrdG9wXCIpXG5cdFx0XHRcdC5zZXREZXNjKFxuXHRcdFx0XHRcdFwiV2hlbiBlbmFibGVkLCB0aGUgZXhpdCBidXR0b24gaXMgaGlkZGVuIG9uIGRlc2t0b3AgYnV0IHJldmVhbHMgaXRzZWxmIG9uIGhvdmVyIGFzIGxvbmcgYXMgdGhlIHplbiBtb2RlIGV4aXQgYnV0dG9uIGlzIG9uLlwiXG5cdFx0XHRcdClcblx0XHRcdFx0LmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxuXHRcdFx0XHRcdHRvZ2dsZVxuXHRcdFx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmF1dG9IaWRlQnV0dG9uT25EZXNrdG9wKVxuXHRcdFx0XHRcdFx0Lm9uQ2hhbmdlKCh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5hdXRvSGlkZUJ1dHRvbk9uRGVza3RvcCA9XG5cdFx0XHRcdFx0XHRcdFx0dmFsdWU7XG5cdFx0XHRcdFx0XHRcdHZvaWQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnJlZnJlc2goKTtcblx0XHRcdFx0XHRcdH0pXG5cdFx0XHRcdCk7XG5cdFx0fSk7XG5cblx0XHRnZW5lcmFsR3JvdXAuYWRkU2V0dGluZygoc2V0dGluZykgPT4ge1xuXHRcdFx0c2V0dGluZ1xuXHRcdFx0XHQuc2V0TmFtZShcIkhpZGUgcHJvcGVydGllcyBpbiB6ZW4gbW9kZVwiKVxuXHRcdFx0XHQuc2V0RGVzYyhcIkhpZGUgcHJvcGVydGllcyB3aGVuIHplbiBtb2RlIGlzIGFjdGl2ZS5cIilcblx0XHRcdFx0LmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxuXHRcdFx0XHRcdHRvZ2dsZVxuXHRcdFx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmhpZGVQcm9wZXJ0aWVzKVxuXHRcdFx0XHRcdFx0Lm9uQ2hhbmdlKCh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5oaWRlUHJvcGVydGllcyA9IHZhbHVlO1xuXHRcdFx0XHRcdFx0XHR2b2lkIHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5yZWZyZXNoKCk7XG5cdFx0XHRcdFx0XHR9KVxuXHRcdFx0XHQpO1xuXHRcdH0pO1xuXG5cdFx0Z2VuZXJhbEdyb3VwLmFkZFNldHRpbmcoKHNldHRpbmcpID0+IHtcblx0XHRcdHNldHRpbmdcblx0XHRcdFx0LnNldE5hbWUoXCJIaWRlIGlubGluZSB0aXRsZSBpbiB6ZW4gbW9kZVwiKVxuXHRcdFx0XHQuc2V0RGVzYyhcblx0XHRcdFx0XHRcIkhpZGUgdGhlIGlubGluZSB0aXRsZSAobm90ZSB0aXRsZSkgd2hlbiB6ZW4gbW9kZSBpcyBhY3RpdmUuXCJcblx0XHRcdFx0KVxuXHRcdFx0XHQuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XG5cdFx0XHRcdFx0dG9nZ2xlXG5cdFx0XHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuaGlkZUlubGluZVRpdGxlKVxuXHRcdFx0XHRcdFx0Lm9uQ2hhbmdlKCh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5oaWRlSW5saW5lVGl0bGUgPSB2YWx1ZTtcblx0XHRcdFx0XHRcdFx0dm9pZCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4ucmVmcmVzaCgpO1xuXHRcdFx0XHRcdFx0fSlcblx0XHRcdFx0KTtcblx0XHR9KTtcblxuXHRcdGdlbmVyYWxHcm91cC5hZGRTZXR0aW5nKChzZXR0aW5nKSA9PiB7XG5cdFx0XHRzZXR0aW5nXG5cdFx0XHRcdC5zZXROYW1lKFwiSGlkZSBzdGF0dXMgYmFyIGluIHplbiBtb2RlXCIpXG5cdFx0XHRcdC5zZXREZXNjKFwiSGlkZSB0aGUgc3RhdHVzIGJhciB3aGVuIHplbiBtb2RlIGlzIGFjdGl2ZS5cIilcblx0XHRcdFx0LmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxuXHRcdFx0XHRcdHRvZ2dsZVxuXHRcdFx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmhpZGVTdGF0dXNCYXIpXG5cdFx0XHRcdFx0XHQub25DaGFuZ2UoKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmhpZGVTdGF0dXNCYXIgPSB2YWx1ZTtcblx0XHRcdFx0XHRcdFx0dm9pZCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4ucmVmcmVzaCgpO1xuXHRcdFx0XHRcdFx0fSlcblx0XHRcdFx0KTtcblx0XHR9KTtcblxuXHRcdGdlbmVyYWxHcm91cC5hZGRTZXR0aW5nKChzZXR0aW5nKSA9PiB7XG5cdFx0XHRzZXR0aW5nXG5cdFx0XHRcdC5zZXROYW1lKFwiVG9wIHBhZGRpbmdcIilcblx0XHRcdFx0LnNldERlc2MoXCJUb3AgcGFkZGluZyBpbiBwaXhlbHMgKDAtMTAwKS5cIilcblx0XHRcdFx0LmFkZFNsaWRlcigoc2xpZGVyKSA9PlxuXHRcdFx0XHRcdHNsaWRlclxuXHRcdFx0XHRcdFx0LnNldExpbWl0cygwLCAxMDAsIDEpXG5cdFx0XHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MudG9wUGFkZGluZylcblx0XHRcdFx0XHRcdC5zZXREeW5hbWljVG9vbHRpcCgpXG5cdFx0XHRcdFx0XHQub25DaGFuZ2UoKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLnRvcFBhZGRpbmcgPSB2YWx1ZTtcblx0XHRcdFx0XHRcdFx0dm9pZCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4ucmVmcmVzaCgpO1xuXHRcdFx0XHRcdFx0fSlcblx0XHRcdFx0KTtcblx0XHR9KTtcblxuXHRcdGdlbmVyYWxHcm91cC5hZGRTZXR0aW5nKChzZXR0aW5nKSA9PiB7XG5cdFx0XHRzZXR0aW5nXG5cdFx0XHRcdC5zZXROYW1lKFwiQm90dG9tIHBhZGRpbmdcIilcblx0XHRcdFx0LnNldERlc2MoXCJCb3R0b20gcGFkZGluZyBpbiBwaXhlbHMgKDAtMTAwKS5cIilcblx0XHRcdFx0LmFkZFNsaWRlcigoc2xpZGVyKSA9PlxuXHRcdFx0XHRcdHNsaWRlclxuXHRcdFx0XHRcdFx0LnNldExpbWl0cygwLCAxMDAsIDEpXG5cdFx0XHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuYm90dG9tUGFkZGluZylcblx0XHRcdFx0XHRcdC5zZXREeW5hbWljVG9vbHRpcCgpXG5cdFx0XHRcdFx0XHQub25DaGFuZ2UoKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmJvdHRvbVBhZGRpbmcgPSB2YWx1ZTtcblx0XHRcdFx0XHRcdFx0dm9pZCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4ucmVmcmVzaCgpO1xuXHRcdFx0XHRcdFx0fSlcblx0XHRcdFx0KTtcblx0XHR9KTtcblxuXHRcdGdlbmVyYWxHcm91cC5hZGRTZXR0aW5nKChzZXR0aW5nKSA9PiB7XG5cdFx0XHRzZXR0aW5nXG5cdFx0XHRcdC5zZXROYW1lKFwiRm9jdXNlZCBmaWxlIG1vZGVcIilcblx0XHRcdFx0LnNldERlc2MoXG5cdFx0XHRcdFx0XCJPbmx5IHNob3cgdGhlIGFjdGl2ZSBmaWxlIGluIHplbiBtb2RlLCBoaWRlIGFsbCBvdGhlciBwYW5lcy5cIlxuXHRcdFx0XHQpXG5cdFx0XHRcdC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cblx0XHRcdFx0XHR0b2dnbGVcblx0XHRcdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5mb2N1c2VkRmlsZU1vZGUpXG5cdFx0XHRcdFx0XHQub25DaGFuZ2UoKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmZvY3VzZWRGaWxlTW9kZSA9IHZhbHVlO1xuXHRcdFx0XHRcdFx0XHR2b2lkIHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5yZWZyZXNoKCk7XG5cdFx0XHRcdFx0XHR9KVxuXHRcdFx0XHQpO1xuXHRcdH0pO1xuXHR9XG59XG4iLCAiLyoqXG4gKiBDb21wYXRpYmlsaXR5IHV0aWxpdGllcyBmb3Igc2V0dGluZ3NcbiAqIFByb3ZpZGVzIGJhY2t3YXJkIGNvbXBhdGliaWxpdHkgZm9yIFNldHRpbmdHcm91cCAocmVxdWlyZXMgQVBJIDEuMTEuMCspXG4gKi9cblxuaW1wb3J0IHsgU2V0dGluZywgcmVxdWlyZUFwaVZlcnNpb24gfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCAqIGFzIE9ic2lkaWFuTW9kdWxlIGZyb20gXCJvYnNpZGlhblwiO1xuXG4vKipcbiAqIEludGVyZmFjZSB0aGF0IHdvcmtzIHdpdGggYm90aCBTZXR0aW5nR3JvdXAgYW5kIGZhbGxiYWNrIGNvbnRhaW5lclxuICovXG5leHBvcnQgaW50ZXJmYWNlIFNldHRpbmdzQ29udGFpbmVyIHtcblx0YWRkU2V0dGluZyhjYjogKHNldHRpbmc6IFNldHRpbmcpID0+IHZvaWQpOiB2b2lkO1xufVxuXG4vKipcbiAqIENyZWF0ZXMgYSBzZXR0aW5ncyBjb250YWluZXIgdGhhdCB1c2VzIFNldHRpbmdHcm91cCBpZiBhdmFpbGFibGUgKEFQSSAxLjExLjArKSxcbiAqIG90aGVyd2lzZSBmYWxscyBiYWNrIHRvIGNyZWF0aW5nIGEgaGVhZGluZyBhbmQgdXNpbmcgdGhlIGNvbnRhaW5lciBkaXJlY3RseS5cbiAqXG4gKiBVc2VzIHJlcXVpcmVBcGlWZXJzaW9uKCcxLjExLjAnKSB0byBjaGVjayBpZiBTZXR0aW5nR3JvdXAgaXMgYXZhaWxhYmxlLlxuICogVGhpcyBpcyB0aGUgb2ZmaWNpYWwgT2JzaWRpYW4gQVBJIG1ldGhvZCBmb3IgdmVyc2lvbiBjaGVja2luZy5cbiAqXG4gKiBAcGFyYW0gY29udGFpbmVyRWwgLSBUaGUgY29udGFpbmVyIGVsZW1lbnQgZm9yIHNldHRpbmdzXG4gKiBAcGFyYW0gaGVhZGluZyAtIFRoZSBoZWFkaW5nIHRleHQgZm9yIHRoZSBzZXR0aW5ncyBncm91cCAob3B0aW9uYWwpXG4gKiBAcGFyYW0gbWFuaWZlc3RJZCAtIFRoZSBwbHVnaW4ncyBtYW5pZmVzdCBJRCBmb3IgQ1NTIHNjb3BpbmcgKHJlcXVpcmVkIGZvciBmYWxsYmFjayBtb2RlKVxuICogQHJldHVybnMgQSBjb250YWluZXIgdGhhdCBjYW4gYmUgdXNlZCB0byBhZGQgc2V0dGluZ3NcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVNldHRpbmdzR3JvdXAoXG5cdGNvbnRhaW5lckVsOiBIVE1MRWxlbWVudCxcblx0aGVhZGluZz86IHN0cmluZyxcblx0bWFuaWZlc3RJZD86IHN0cmluZ1xuKTogU2V0dGluZ3NDb250YWluZXIge1xuXHQvLyBDaGVjayBpZiBTZXR0aW5nR3JvdXAgaXMgYXZhaWxhYmxlIChBUEkgMS4xMS4wKylcblx0Ly8gcmVxdWlyZUFwaVZlcnNpb24gaXMgdGhlIG9mZmljaWFsIE9ic2lkaWFuIEFQSSBtZXRob2QgZm9yIHZlcnNpb24gY2hlY2tpbmdcblx0aWYgKHJlcXVpcmVBcGlWZXJzaW9uKFwiMS4xMS4wXCIpKSB7XG5cdFx0Ly8gVXNlIFNldHRpbmdHcm91cCAtIGl0J3MgZ3VhcmFudGVlZCB0byBleGlzdCBpZiByZXF1aXJlQXBpVmVyc2lvbiByZXR1cm5zIHRydWVcblx0XHQvLyBBY2Nlc3MgU2V0dGluZ0dyb3VwIHZpYSB0eXBlIGFzc2VydGlvbiBzaW5jZSBpdCBtYXkgbm90IGJlIGluIHR5cGUgZGVmaW5pdGlvbnNcblx0XHQvLyBmb3Igb2xkZXIgVHlwZVNjcmlwdCB2ZXJzaW9ucywgYnV0IGV4aXN0cyBhdCBydW50aW1lIGluIE9ic2lkaWFuIDEuMTEuMCtcblx0XHQvLyBVc2luZyB1bmtub3duIGluc3RlYWQgb2YgYW55IHRvIHNhdGlzZnkgZXNsaW50IHdoaWxlIG1haW50YWluaW5nIHR5cGUgc2FmZXR5XG5cdFx0Y29uc3QgU2V0dGluZ0dyb3VwQ2xhc3MgPSAoXG5cdFx0XHRPYnNpZGlhbk1vZHVsZSBhcyB1bmtub3duIGFzIHtcblx0XHRcdFx0U2V0dGluZ0dyb3VwPzogbmV3IChjb250YWluZXJFbDogSFRNTEVsZW1lbnQpID0+IHtcblx0XHRcdFx0XHRzZXRIZWFkaW5nKGhlYWRpbmc6IHN0cmluZyk6IHtcblx0XHRcdFx0XHRcdGFkZFNldHRpbmcoY2I6IChzZXR0aW5nOiBTZXR0aW5nKSA9PiB2b2lkKTogdm9pZDtcblx0XHRcdFx0XHR9O1xuXHRcdFx0XHRcdGFkZFNldHRpbmcoY2I6IChzZXR0aW5nOiBTZXR0aW5nKSA9PiB2b2lkKTogdm9pZDtcblx0XHRcdFx0fTtcblx0XHRcdH1cblx0XHQpLlNldHRpbmdHcm91cDtcblxuXHRcdGlmIChTZXR0aW5nR3JvdXBDbGFzcykge1xuXHRcdFx0Y29uc3QgZ3JvdXAgPSBoZWFkaW5nXG5cdFx0XHRcdD8gbmV3IFNldHRpbmdHcm91cENsYXNzKGNvbnRhaW5lckVsKS5zZXRIZWFkaW5nKGhlYWRpbmcpXG5cdFx0XHRcdDogbmV3IFNldHRpbmdHcm91cENsYXNzKGNvbnRhaW5lckVsKTtcblx0XHRcdHJldHVybiB7XG5cdFx0XHRcdGFkZFNldHRpbmcoY2I6IChzZXR0aW5nOiBTZXR0aW5nKSA9PiB2b2lkKSB7XG5cdFx0XHRcdFx0Z3JvdXAuYWRkU2V0dGluZyhjYik7XG5cdFx0XHRcdH0sXG5cdFx0XHR9O1xuXHRcdH1cblx0fVxuXG5cdC8vIEZhbGxiYWNrIHBhdGggKGVpdGhlciBBUEkgPCAxLjExLjAgb3IgU2V0dGluZ0dyb3VwIG5vdCBmb3VuZClcblx0Ly8gQWRkIHNjb3BpbmcgY2xhc3MgdG8gY29udGFpbmVyRWwgdG8gc2NvcGUgQ1NTIHRvIG9ubHkgdGhpcyBwbHVnaW4ncyBzZXR0aW5nc1xuXHRpZiAobWFuaWZlc3RJZCkge1xuXHRcdGNvbnRhaW5lckVsLmFkZENsYXNzKGAke21hbmlmZXN0SWR9LXNldHRpbmdzLWNvbXBhdGApO1xuXHR9XG5cblx0e1xuXHRcdC8vIEZhbGxiYWNrOiBDcmVhdGUgYSBoZWFkaW5nIG1hbnVhbGx5IGZvciBvbGRlciBBUEkgdmVyc2lvbnNcblx0XHQvLyBOb3RlOiBXaGlsZSBiZXN0IHByYWN0aWNlIHByZWZlcnMgU2V0dGluZy5zZXRIZWFkaW5nKCksIHRoZSBmYWxsYmFjayBwYXRoXG5cdFx0Ly8gaXMgZm9yIHZlcnNpb25zIHRoYXQgbWF5IG5vdCBzdXBwb3J0IGl0LCBzbyBtYW51YWwgaGVhZGluZyBpcyBhcHByb3ByaWF0ZSBoZXJlXG5cdFx0aWYgKGhlYWRpbmcpIHtcblx0XHRcdGNvbnN0IGhlYWRpbmdFbCA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdihcInNldHRpbmctZ3JvdXAtaGVhZGluZ1wiKTtcblx0XHRcdGhlYWRpbmdFbC5jcmVhdGVFbChcImgzXCIsIHsgdGV4dDogaGVhZGluZyB9KTtcblx0XHR9XG5cblx0XHRyZXR1cm4ge1xuXHRcdFx0YWRkU2V0dGluZyhjYjogKHNldHRpbmc6IFNldHRpbmcpID0+IHZvaWQpIHtcblx0XHRcdFx0Y29uc3Qgc2V0dGluZyA9IG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKTtcblx0XHRcdFx0Y2Ioc2V0dGluZyk7XG5cdFx0XHR9LFxuXHRcdH07XG5cdH1cbn1cbiIsICIvKipcbiAqIEhlbHBlciBmdW5jdGlvbiB0byBzZXQgQ1NTIHByb3BlcnRpZXMgb24gYW4gZWxlbWVudC5cbiAqIENvbnZlcnRzIGNhbWVsQ2FzZSBwcm9wZXJ0eSBuYW1lcyB0byBrZWJhYi1jYXNlIGZvciBDU1MuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzZXRDc3NQcm9wcyhcblx0ZWxlbWVudDogSFRNTEVsZW1lbnQsXG5cdHByb3BzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+XG4pOiB2b2lkIHtcblx0T2JqZWN0LmVudHJpZXMocHJvcHMpLmZvckVhY2goKFtrZXksIHZhbHVlXSkgPT4ge1xuXHRcdGNvbnN0IGNzc0tleSA9IGtleS5yZXBsYWNlKC8oW2Etel0pKFtBLVpdKS9nLCBcIiQxLSQyXCIpLnRvTG93ZXJDYXNlKCk7XG5cdFx0ZWxlbWVudC5zdHlsZS5zZXRQcm9wZXJ0eShjc3NLZXksIHZhbHVlKTtcblx0fSk7XG59XG4iXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7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QUFBLFVBRVI7QUFBQSxRQUNEO0FBR0EsYUFBSyxTQUFTLFVBQVU7QUFDeEIsY0FBTSxLQUFLLGFBQWE7QUFDeEIsYUFBSyxRQUFRO0FBQUEsTUFDZCxPQUFPO0FBRU4sWUFBSSxTQUFTLHFCQUFxQixTQUFTLGdCQUFnQjtBQUMxRCxjQUFJO0FBQ0gsa0JBQU0sU0FBUyxlQUFlO0FBRTlCLGtCQUFNLElBQUk7QUFBQSxjQUFRLENBQUMsWUFDbEIsc0JBQXNCLE9BQU87QUFBQSxZQUM5QjtBQUFBLFVBQ0QsU0FBUTtBQUFBLFVBRVI7QUFBQSxRQUNEO0FBR0EsYUFBSyxTQUFTLFVBQVU7QUFDeEIsY0FBTSxLQUFLLGFBQWE7QUFDeEIsYUFBSyxRQUFRO0FBQUEsTUFDZDtBQUFBLElBQ0QsVUFBRTtBQUVELFdBQUssaUJBQWlCO0FBQUEsSUFDdkI7QUFBQSxFQUNEO0FBQ0Q7IiwKICAibmFtZXMiOiBbImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiYWxsVGFiQ29udGFpbmVycyJdCn0K
